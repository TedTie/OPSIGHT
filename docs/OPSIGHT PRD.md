# 🧭 OPSIGHT — 产品需求文档 (PRD)
**版本号：** 1.0
**最后更新：** 2025-10-24
**状态：** 内部立项用
**编制人：** 产品经理部 (联合 AI 架构组)

---

## 🪧 一、产品概述

### **产品名称**
**OPSIGHT**

### **一句话定义**
> OPSIGHT 是一款 **AI‑Native 的任务分析与日报生成平台**，让 AI 成为团队的思考中枢，而不只是辅助工具。

### **产品使命**
通过智能任务追踪、AI日报生成、情绪分析与决策洞察，帮助组织建立「高认知协作系统」，让每个成员都在 AI 与事实数据支持下自我提升、团队成长。

### **核心价值主张**
| 产品价值 | 说明 |
|-----------|------|
| 🧠 智能反思 | 自动生成日报摘要与反思，帮助个人成长 |
| 📊 实时洞察 | AI 洞察群体状态与协作情绪趋势 |
| ⚙️ 自定义指标 | 企业可自定义管理公式，例如绩效分/幸福值 |
| 🔐 数据安全 | 所有AI调用走统一的OpenRouter通道，可控、合规 |

---

## 🧭 二、产品目标与愿景

### 2.1 产品愿景
- 企业层：AI‑Native 的运营中台，助力决策透明化与风险前置。
- 团队层：让团队整体协作质量可被AI实时建模。
- 个体层：将日报变为真正的「自我认知与输出工具」。

### 2.2 产品目标（首期版本）
| 阶段 | 目标 |
|------|------|
| 🚀 MVP 阶段 | 实现场景闭环——用户任务、日报、AI反馈、趋势图表。 |
| ⚙️ 版本 V1.0 | 支持Admin/组别/超级管理员权限体系。 |
| 🔁 版本 V2.0 | 接入多模型对比分析与自定义指标编辑器。 |

---

## 👥 三、目标用户与角色定义

| 角色 | 用户画像 | 核心诉求 |
|------|-----------|----------|
| 普通成员（CC/SS/LP） | 一线执行者 | 快速提交日报、获得AI总结、了解自身状态 |
| 管理员 (如组长/部门负责人) | 中层管理者 | 洞察团队任务进展、发现异常情绪 |
| 超级管理员 (HR/COO/ CEO 助理等) | 企业运营核心 | 系统管理、指标创建、AI配置、安全控制 |

---

## 🔄 四、核心用户流程 (User Journeys)

### 4.1 普通用户流程（CC/SS/LP）
1. 登录进入个人主页；
2. 查看任务 → 更新进度；
3. 填写日报 → 提交；
4. 系统调用 AI（经 OpenRouter）返回：
   - 情绪分析（正/负/中性）
   - 情绪分数（0~1）
   - AI 反思建议；
5. 用户可在「我的分析」页查看趋势图（任务完整率 / 情感走向）；
6. 可导出个人周报。

**用户收益：**
- 自动总结、摆脱重复编写；
- 量化情绪与绩效；
- 能实时理解自己工作的质感。

---

### 4.2 管理员流程（组别负责人）
1. 登录 → 查看小组Dashboard；
2. 创建与派发任务 → 选择范围（组/身份/全体）；
3. 审核或查看组内日报；
4. 系统自动计算：
   - 平均情感值
   - 异常日报数量
   - 提交率
5. 在「团队分析」页中生成趋势图；
6. 调用AI智能总结形成「本组周度汇报」：
   ```
   示例输出：
   “SS组平均情绪指数0.74，完成率92%，相比上周提升3%。”
   ```

**管理员收益：**
- 实时掌握组内动态；
- 系统自动标注异常报告；
- AI提供总结，不需人工整理。

---

### 4.3 超级管理员流程（企业管理员）
1. 登录 → 后台页面；
2. 管理用户 / 组 / 身份层；
3. 维护系统级指标公式；
4. 配置 AI 参数：
   - 选择模型（Gemini / GPT‑5 / DeepSeek）
   - 填写 OpenRouter API Key；
5. 查看全公司分析报告；
6. 监控 AI 调用日志、安全与配额。

**收益：**
- 管理一切AI行为；
- 统一指标体系；
- 实时洞察企业健康指数。

---

## 🧩 五、核心功能模块定义

| 模块名称 | 模块说明 | 用户角色 |
|-----------|-----------|-----------|
| 登录与权限 | 基于角色跳转不同首页（JWT 验证） | 全体 |
| 任务模块 | 创建、指派、查询、状态流转 | 管理员/超管/普通用户 |
| 日报模块 | 提交日报+自动AI分析 | 全体 |
| 分析中心 | 图表与统计（ECharts 可视化） | 全体 |
| AI 模块（OpenRouter） | AI 调用/模型切换/日志追踪 | 全体 |
| 自定义指标 | 自由定义公式、系统计算 | 超级管理员 |
| 系统配置 | 用户/组/AI密钥管理 | 超级管理员 |

---

## ⚙️ 六、AI 模块说明

### 6.1 模块定位
OPSIGHT 的核心差异点在于「**AI‑Native 架构**」。
AI 不再是附属功能，而是平台的第一层“智能中枢”：

| Agent | 职责 | 使用模型 |
|-------|------|----------|
| EmotionAgent | 分析日报情绪 | GPT‑5 / DeepSeek |
| ReflectionAgent | 提炼日报摘要与反思 | GPT‑5 / Gemini |
| AnalyticsAgent | 生成周期性组别总结 | Gemini |

### 6.2 模型调用标准 (同V6.0 技术方案)
- 调用端点： `https://openrouter.ai/api/v1/chat/completions`
- API Key只能由超级管理员配置
- 所有请求头完整保留 Referer 与 X‑Title
- 模型参数由配置中心动态读取

---

## 📈 七、关键体验场景 (UX Scenarios)

| 场景编号 | 场景描述 | 涉及模块 | AI介入点 |
|------------|------------|------------|------------|
| S1 | 用户提交日报 | 日报模块 | 情感识别 + 摘要生成 |
| S2 | 管理员查看组别日报 | 分析中心 | AI 生成智能总结 |
| S3 | 超级管理员调整模型 | 系统设置 | 模型切换、OpenRouter参数更新 |
| S4 | 周分析报告导出 | 分析中心 | AI 生成自然语言报告内容 |

---

## 📊 八、核心数据与指标体系

### 8.1 系统默认指标
| 指标名称 | 来源 | 计算方式 |
|-----------|-------|-----------|
| 完成率 | task.status | 完成任务数 / 总任务数 |
| 提交率 | report.count | 有日报人数 / 全体人数 |
| 情感均值 | ai_results.emotion_score | 平均值 |
| 异常率 | ai_results.emotion_score < 0.3 | 条件统计 |
| 幸福感趋势 | 多日报情绪移动平均值 | 时间维度曲线 |

### 8.2 自定义指标（公式系统）
由超级管理员配置的脚本公式，例如：
```
稳定指数 = (完成率 * 0.6) + (情绪均值 * 0.4)
```
系统自动在前端与分析模块联动计算。

---

## 🧱 九、页面信息架构 (IA)

### 9.1 用户端
- 主页 /dashboard
- 我的任务 /tasks
- 日报提交 /report
- 分析中心 /analysis

### 9.2 管理员端
- 任务中心 /admin/tasks
- 日报审查 /admin/reports
- 团队分析 /admin/analytics

### 9.3 超级管理员端
- 用户与组管理 /super/users
- 指标与模型管理 /super/metrics
- AI 配置页 /super/ai
- 系统日志 /super/logs

---

## 🔐 十、安全与合规

| 要点 | 说明 |
|------|------|
| 登录验证 | JWT 鉴权，角色对应菜单 |
| 密码存储 | bcrypt 加密 |
| AI 接口安全 | Key 仅超管配置、AES256 加密存放 |
| 通信安全 | HTTPS 强制 |
| 调用追踪 | AI 调用日志记录 user_id/model/response_ms |
| 调用速率限制 | 10次/分钟/用户 |

---

## ☁️ 十一、非功能性需求 (NFR)

| 分类 | 目标 |
|------|------|
| 可靠性 | 系统99.5%可用，支持200并发用户 |
| 响应性能 | 任务查询 < 200ms，AI分析延迟 < 4s |
| 可维护性 | 模块化结构，前后端独立部署 |
| 安全性 | 数据加密传输与存储 |
| 国际化 | 未来版本支持中/英语言切换 |

---

## 🧰 十二、技术依赖与集成

| 范畴 | 依赖 | 说明 |
|------|------|------|
| 前端 | Vue3 + Element Plus | UI组件 |
| 后端 | FastAPI | 主服务框架 |
| AI接口 | OpenRouter API | AI接入中间层 |
| 数据库 | PostgreSQL + SQLAlchemy | 持久化 |
| 缓存 | Redis | AI结果缓存 |
| 图表 | ECharts | 统计可视化 |
| 部署 | Docker + Nginx | 一体化部署方案 |

---

## 🧩 十三、MVP 范围说明

**首期上线功能：**
- 用户/管理员/超管三层登录
- 任务派发与状态流转
- 日报填写与AI分析
- 情绪得分与反思生成
- 团队趋势图表
- AI模型切换（OpenRouter接口）

**暂缓功能：**
- 模型多路并行比较
- 语音日报输入
- Slack/企业微信通知

---

## 🗂 十四、版本规划（Roadmap）

| 阶段 | 时间 | 版本号 | 功能重点 |
|------|------|--------|----------|
| 阶段1 | 2024 Q3 | v1.0 | MVP功能闭环，AI情感分析模块 |
| 阶段2 | 2024 Q4 | v1.5 | 自定义指标系统 + 周报导出 |
| 阶段3 | 2025 Q1 | v2.0 | 多模型对比、增强可视层 |
| 阶段4 | 2025 Q2 | v2.5 | 与IM系统（Slack/企微）集成 |

---

## 🧮 十五、关键KPI指标

| KPI | 指标说明 | 成功标准 |
|-----|-----------|-----------|
| 日报提交率 | 每日实际提交人数 / 总注册人数 | ≥ 85% |
| 平均情感分波动率 | 周环比变化 | 稳定性越高越好 |
| 异常日报响应时间 | 管理员识别并处理的时间 | ≤ 24h |
| AI反馈准确率 | 用户认为AI总结与实际一致度 | ≥ 80% |
| 模型调用成功率 | OpenRouter请求成功率 | ≥ 99% |

---

## ✅ 十六、PRD 附录

### 16.1 命名规范
- 模块名：全小写 + 下划线
- 接口遵循 RESTful
- 报告类型以 `report_type`字段区分（日报/周报）

### 16.2 权限矩阵

| 模块 | 用户 | 管理员 | 超管 |
|------|------|------|------|
| 查看任务 | ✅ | ✅ | ✅ |
| 创建任务 | ❌ | ✅ | ✅ |
| 提交日报 | ✅ | ✅ | ✅ |
| 查看组日报 | ❌ | ✅ | ✅ |
| 创建指标 | ❌ | ❌ | ✅ |
| 切换模型 | ❌ | ❌ | ✅ |

### 16.3 术语表
| 术语 | 含义 |
|------|------|
| AI情感分 | 表征日报文本的AI情绪计算结果(0~1) |
| AI反思 | 系统自动生成的自我总结与改进建议 |
| Custom Metric | 超级管理员自定义计算公式指标 |
| OpenRouter | 统一AI模型路由与安全代理层 |
| EmotionAgent | AI 负责情感计算模块 |
| ReflectionAgent | AI 负责内容反思生成模块 |

---

## 🎯 十七、总结与价值

OPSIGHT 是一款为「智能协作」而生的任务与日报管理平台。
它的革命性不在于「自动化」，而在于 **“认知增强”** ——
让 AI 不再只是帮你记录工作，而是 **帮你理解工作**。

