import{r as u,L as M,c as Ce,o as lt,l as k,f as s,g as t,w as l,b as c,P as V,E as m,Q as nt,e as _,t as i,U as J,d as A,k as o,h as C,V as ze,F as me,n as _e,Y as Ae,m as K,y as W}from"./index-g0Sg6k74.js";import{a as P}from"./date-CxVpZo2G.js";import{_ as st}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ot={class:"page-container"},it={class:"stats-overview"},dt={class:"stat-content"},rt={class:"stat-value"},ut={class:"stat-sub"},pt={class:"stat-content"},ct={class:"stat-value"},mt={class:"stat-sub"},_t={class:"stat-content"},ft={class:"stat-value"},gt={class:"stat-sub"},vt={class:"stat-content"},yt={class:"stat-value"},bt={class:"stat-sub"},wt={class:"card-header"},Vt={class:"card-header"},xt={key:0},kt={class:"card-header"},ht={class:"header-actions"},Ct={class:"config-description"},zt={style:{display:"flex","justify-content":"space-between","align-items":"center"}},At={class:"card-header"},Ft={class:"header-actions"},Tt={class:"text-ellipsis"},Ut={key:0},$t={key:1},It={class:"pagination-container"},Dt={key:0,class:"log-detail"},qt={class:"log-content"},Bt={class:"content-box"},Lt={class:"content-box"},St={key:0},Rt={class:"content-box error"},jt={key:0},Et={key:0,class:"test-result"},Ot={class:"content-box"},Mt={__name:"AdminAI",setup(Pt){const fe=u("agents"),X=u(!1),Z=u(!1),ee=u(!1),T=u(!1),te=u(!1),ae=u([]),le=u([]),ge=u([]),ne=u([]),se=u(!1),x=M({total_agents:0,active_agents:0,total_functions:0,active_functions:0,total_calls:0,success_calls:0,failed_calls:0,today_calls:0}),U=u(!1),$=u(!1),oe=u(!1),N=u(!1),B=u(!1),L=u(!1),ie=u(),de=u(),p=M({name:"",description:"",provider:"openai",model_name:"",system_prompt:"",temperature:.7,max_tokens:4e3,is_active:!0}),v=M({name:"",description:"",function_type:"text_generation",agent_id:null,is_active:!0}),S=M({function_id:null,status:null}),z=M({page:1,size:20,total:0}),b=u(null),R=u(null),j=u(""),E=u(null),Fe={name:[{required:!0,message:"请输入智能体名称",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}],provider:[{required:!0,message:"请选择模型提供商",trigger:"change"}],model_name:[{required:!0,message:"请输入模型名称",trigger:"blur"}],system_prompt:[{required:!0,message:"请输入系统提示词",trigger:"blur"}]},Te={name:[{required:!0,message:"请输入功能名称",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}],function_type:[{required:!0,message:"请选择功能类型",trigger:"change"}]},Ue=Ce(()=>x.total_calls===0?0:Math.round(x.success_calls/x.total_calls*100)),ve=Ce(()=>ae.value.filter(n=>n.is_active)),re=n=>({openai:"OpenAI",claude:"Claude",gemini:"Gemini",other:"其他"})[n]||n,$e=n=>({text_generation:"文本生成",text_analysis:"文本分析",translation:"翻译",summarization:"摘要",qa:"问答",other:"其他"})[n]||n,ye=n=>({success:"成功",failed:"失败",pending:"进行中"})[n]||n,be=n=>({openai:"primary",claude:"success",gemini:"warning",other:"info"})[n]||"info",Ie=n=>({text_generation:"primary",text_analysis:"success",translation:"warning",summarization:"info",qa:"danger",other:"info"})[n]||"info",we=n=>({success:"success",failed:"danger",pending:"warning"})[n]||"info",De=n=>({文本分析:"primary",内容生成:"success",数据分析:"warning",问答系统:"info"})[n]||"info",qe=n=>n||"未分类",Be=(n,e)=>{const f=new Date(n);return new Date(e).getTime()-f.getTime()},O=async()=>{try{const n=await V.get("/ai/stats");Object.assign(x,n.data)}catch(n){console.error("获取统计信息失败:",n)}},ue=async()=>{X.value=!0;try{const n=await V.get("/ai/agents");ae.value=n.data||[]}catch{m.error("获取智能体列表失败")}finally{X.value=!1}},pe=async()=>{Z.value=!0;try{const n=await V.get("/ai/functions");le.value=n.data||[]}catch{m.error("获取AI功能列表失败")}finally{Z.value=!1}},I=async()=>{ee.value=!0;try{const n={page:z.page,size:z.size,...S},e=await V.get("/ai/logs",{params:n});ge.value=e.data.items||[],z.total=e.data.total||0}catch{m.error("获取调用日志失败")}finally{ee.value=!1}},Le=()=>{B.value=!1,Ee(),U.value=!0},Se=n=>{B.value=!0,Object.assign(p,n),U.value=!0},Re=n=>{W.alert(`<p><strong>名称：</strong>${n.name}</p>
     <p><strong>描述：</strong>${n.description}</p>
     <p><strong>提供商：</strong>${re(n.provider)}</p>
     <p><strong>模型：</strong>${n.model_name}</p>
     <p><strong>系统提示词：</strong></p>
     <div style="max-height: 200px; overflow-y: auto; background: #f5f5f5; padding: 10px; border-radius: 4px;">${n.system_prompt}</div>`,"智能体详情",{dangerouslyUseHTMLString:!0,confirmButtonText:"关闭"})},je=async n=>{try{await W.confirm(`确定要删除智能体 "${n.name}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await V.delete(`/ai/agents/${n.id}`),m.success("删除成功"),ue(),O()}catch(e){e!=="cancel"&&m.error("删除失败")}},Ee=()=>{var n;Object.assign(p,{name:"",description:"",provider:"openai",model_name:"",system_prompt:"",temperature:.7,max_tokens:4e3,is_active:!0}),(n=ie.value)==null||n.clearValidate()},Oe=async()=>{try{await ie.value.validate(),T.value=!0,B.value?(await V.put(`/ai/agents/${p.id}`,p),m.success("更新成功")):(await V.post("/ai/agents",p),m.success("创建成功")),U.value=!1,ue(),O()}catch{m.error(B.value?"更新失败":"创建失败")}finally{T.value=!1}},Me=()=>{L.value=!1,Ge(),$.value=!0},Pe=n=>{L.value=!0,Object.assign(v,n),$.value=!0},Ne=async n=>{try{await W.confirm(`确定要删除AI功能 "${n.name}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await V.delete(`/ai/functions/${n.id}`),m.success("删除成功"),pe(),O()}catch(e){e!=="cancel"&&m.error("删除失败")}},Ge=()=>{var n;Object.assign(v,{name:"",description:"",function_type:"text_generation",agent_id:null,is_active:!0}),(n=de.value)==null||n.clearValidate()},He=async()=>{try{await de.value.validate(),T.value=!0,L.value?(await V.put(`/ai/functions/${v.id}`,v),m.success("更新成功")):(await V.post("/ai/functions",v),m.success("创建成功")),$.value=!1,pe(),O()}catch{m.error(L.value?"更新失败":"创建失败")}finally{T.value=!1}},Qe=n=>{R.value=n,j.value="",E.value=null,N.value=!0},Ye=async()=>{if(!j.value.trim()){m.warning("请输入测试内容");return}te.value=!0;try{const n=await V.post("/ai/call",{function_id:R.value.id,input_text:j.value});E.value=n.data,m.success("测试完成")}catch{m.error("测试失败")}finally{te.value=!1}},Je=n=>{b.value=n,oe.value=!0},Ve=async()=>{se.value=!0;try{ne.value=[{id:"emotion_analysis",name:"情感分析",description:"分析用户日报中的情感状态，识别积极、消极或中性情绪",category:"文本分析",endpoint:"/api/ai/emotion",current_agent_id:null,current_agent_name:"未配置",is_enabled:!0},{id:"reflection_generation",name:"反思生成",description:"基于用户日报内容生成深度反思和改进建议",category:"内容生成",endpoint:"/api/ai/reflection",current_agent_id:null,current_agent_name:"未配置",is_enabled:!0},{id:"task_analysis",name:"任务分析",description:"分析任务完成情况，识别效率瓶颈和改进点",category:"数据分析",endpoint:"/api/ai/analytics",current_agent_id:null,current_agent_name:"未配置",is_enabled:!0},{id:"report_summary",name:"报告总结",description:"自动生成团队周报和月报摘要",category:"内容生成",endpoint:"/api/ai/summary",current_agent_id:null,current_agent_name:"未配置",is_enabled:!0},{id:"knowledge_qa",name:"知识问答",description:"基于项目知识库回答用户问题",category:"问答系统",endpoint:"/api/ai/qa",current_agent_id:null,current_agent_name:"未配置",is_enabled:!1},{id:"data_insights",name:"数据洞察",description:"分析工作数据，提供业务洞察和建议",category:"数据分析",endpoint:"/api/ai/insights",current_agent_id:null,current_agent_name:"未配置",is_enabled:!1}];const e=(await V.get("/ai/system-config")).data||{};ne.value.forEach(f=>{const r=e[f.id];r&&(f.current_agent_id=r.agent_id,f.current_agent_name=r.agent_name||"未配置",f.is_enabled=r.is_enabled!==!1)})}catch(n){console.error("获取系统功能配置失败:",n),m.error("获取系统功能配置失败")}finally{se.value=!1}},Ke=async n=>{try{if(!n.current_agent_id){m.warning("请先为该功能配置智能体");return}const e={emotion_analysis:"今天工作很顺利，完成了所有任务，心情不错。",reflection_generation:"今天遇到了一些技术难题，花了很多时间调试。",task_analysis:"完成了3个任务，其中1个超时，2个按时完成。",report_summary:"本周团队完成了项目的核心功能开发。",knowledge_qa:"如何优化数据库查询性能？",data_insights:"用户活跃度数据：周一100人，周二120人，周三95人。"},f=await V.post("/ai/test-function",{function_id:n.id,input_text:e[n.id]||"测试输入内容"});W.alert(`<div style="max-height: 300px; overflow-y: auto;">
        <p><strong>测试结果：</strong></p>
        <div style="background: #f5f5f5; padding: 10px; border-radius: 4px; margin: 10px 0;">${f.data.output_text}</div>
        <p><small>Token消耗: ${f.data.tokens_used||0}</small></p>
      </div>`,"功能测试结果",{dangerouslyUseHTMLString:!0,confirmButtonText:"关闭"})}catch{m.error("测试失败")}};return lt(()=>{O(),ue(),pe(),I(),Ve()}),(n,e)=>{const f=c("el-card"),r=c("el-button"),d=c("el-table-column"),h=c("el-tag"),G=c("el-table"),H=c("el-tab-pane"),We=c("el-alert"),y=c("el-option"),D=c("el-select"),Xe=c("el-tooltip"),Ze=c("el-pagination"),et=c("el-tabs"),F=c("el-input"),w=c("el-form-item"),xe=c("el-input-number"),ke=c("el-col"),tt=c("el-row"),he=c("el-switch"),ce=c("el-form"),Q=c("el-dialog"),q=c("el-descriptions-item"),at=c("el-descriptions"),Y=nt("loading");return _(),k("div",ot,[e[59]||(e[59]=s("div",{class:"page-header"},[s("h1",{class:"page-title"},"AI智能体管理"),s("p",{class:"page-description"},"配置智能体、管理AI功能和监控调用日志")],-1)),s("div",it,[t(f,{class:"stat-card"},{default:l(()=>[s("div",dt,[s("div",rt,i(x.total_agents),1),e[26]||(e[26]=s("div",{class:"stat-label"},"智能体总数",-1)),s("div",ut,"活跃: "+i(x.active_agents),1)])]),_:1}),t(f,{class:"stat-card"},{default:l(()=>[s("div",pt,[s("div",ct,i(x.total_functions),1),e[27]||(e[27]=s("div",{class:"stat-label"},"AI功能总数",-1)),s("div",mt,"活跃: "+i(x.active_functions),1)])]),_:1}),t(f,{class:"stat-card"},{default:l(()=>[s("div",_t,[s("div",ft,i(x.total_calls),1),e[28]||(e[28]=s("div",{class:"stat-label"},"总调用次数",-1)),s("div",gt,"今日: "+i(x.today_calls),1)])]),_:1}),t(f,{class:"stat-card"},{default:l(()=>[s("div",vt,[s("div",yt,i(Ue.value)+"%",1),e[29]||(e[29]=s("div",{class:"stat-label"},"成功率",-1)),s("div",bt,"失败: "+i(x.failed_calls),1)])]),_:1})]),t(et,{modelValue:fe.value,"onUpdate:modelValue":e[4]||(e[4]=a=>fe.value=a),class:"main-tabs"},{default:l(()=>[t(H,{label:"智能体配置",name:"agents"},{default:l(()=>[t(f,{class:"content-card"},{header:l(()=>[s("div",wt,[e[31]||(e[31]=s("span",null,"智能体列表",-1)),t(r,{type:"primary",icon:C(ze),onClick:Le},{default:l(()=>[...e[30]||(e[30]=[o(" 新增智能体 ",-1)])]),_:1},8,["icon"])])]),default:l(()=>[J((_(),A(G,{data:ae.value,stripe:"",style:{width:"100%"}},{default:l(()=>[t(d,{prop:"name",label:"智能体名称",width:"150"}),t(d,{prop:"description",label:"描述","min-width":"200"}),t(d,{prop:"provider",label:"模型提供商",width:"120"},{default:l(({row:a})=>[t(h,{type:be(a.provider),size:"small"},{default:l(()=>[o(i(re(a.provider)),1)]),_:2},1032,["type"])]),_:1}),t(d,{prop:"model_name",label:"模型",width:"180"}),t(d,{label:"状态",width:"80"},{default:l(({row:a})=>[t(h,{type:a.is_active?"success":"danger",size:"small"},{default:l(()=>[o(i(a.is_active?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(d,{prop:"created_at",label:"创建时间",width:"180"},{default:l(({row:a})=>[o(i(C(P)(a.created_at)),1)]),_:1}),t(d,{label:"操作",width:"200",fixed:"right"},{default:l(({row:a})=>[t(r,{type:"text",size:"small",onClick:g=>Re(a)},{default:l(()=>[...e[32]||(e[32]=[o(" 查看 ",-1)])]),_:1},8,["onClick"]),t(r,{type:"text",size:"small",onClick:g=>Se(a)},{default:l(()=>[...e[33]||(e[33]=[o(" 编辑 ",-1)])]),_:1},8,["onClick"]),t(r,{type:"text",size:"small",onClick:g=>je(a)},{default:l(()=>[...e[34]||(e[34]=[o(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Y,X.value]])]),_:1})]),_:1}),t(H,{label:"AI功能配置",name:"functions"},{default:l(()=>[t(f,{class:"content-card"},{header:l(()=>[s("div",Vt,[e[36]||(e[36]=s("span",null,"AI功能列表",-1)),t(r,{type:"primary",icon:C(ze),onClick:Me},{default:l(()=>[...e[35]||(e[35]=[o(" 新增AI功能 ",-1)])]),_:1},8,["icon"])])]),default:l(()=>[J((_(),A(G,{data:le.value,stripe:"",style:{width:"100%"}},{default:l(()=>[t(d,{prop:"name",label:"功能名称",width:"150"}),t(d,{prop:"description",label:"描述","min-width":"200"}),t(d,{prop:"function_type",label:"功能类型",width:"120"},{default:l(({row:a})=>[t(h,{type:Ie(a.function_type),size:"small"},{default:l(()=>[o(i($e(a.function_type)),1)]),_:2},1032,["type"])]),_:1}),t(d,{label:"关联智能体",width:"180"},{default:l(({row:a})=>[a.agent_name?(_(),k("span",xt,i(a.agent_name),1)):(_(),A(h,{key:1,type:"warning",size:"small"},{default:l(()=>[...e[37]||(e[37]=[o("未配置",-1)])]),_:1}))]),_:1}),t(d,{label:"状态",width:"80"},{default:l(({row:a})=>[t(h,{type:a.is_active?"success":"danger",size:"small"},{default:l(()=>[o(i(a.is_active?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(d,{prop:"created_at",label:"创建时间",width:"180"},{default:l(({row:a})=>[o(i(C(P)(a.created_at)),1)]),_:1}),t(d,{label:"操作",width:"200",fixed:"right"},{default:l(({row:a})=>[t(r,{type:"text",size:"small",onClick:g=>Qe(a)},{default:l(()=>[...e[38]||(e[38]=[o(" 测试 ",-1)])]),_:1},8,["onClick"]),t(r,{type:"text",size:"small",onClick:g=>Pe(a)},{default:l(()=>[...e[39]||(e[39]=[o(" 编辑 ",-1)])]),_:1},8,["onClick"]),t(r,{type:"text",size:"small",onClick:g=>Ne(a)},{default:l(()=>[...e[40]||(e[40]=[o(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Y,Z.value]])]),_:1})]),_:1}),t(H,{label:"功能配置",name:"config"},{default:l(()=>[t(f,{class:"content-card"},{header:l(()=>[s("div",kt,[e[42]||(e[42]=s("span",null,"AI功能配置",-1)),s("div",ht,[t(r,{icon:C(Ae),onClick:Ve},{default:l(()=>[...e[41]||(e[41]=[o("刷新",-1)])]),_:1},8,["icon"])])])]),default:l(()=>[s("div",Ct,[t(We,{title:"功能说明",description:"以下是系统中所有使用AI功能的地方，您可以为每个功能选择对应的智能体，就像为不同文件类型选择默认应用程序一样。",type:"info",closable:!1,style:{"margin-bottom":"20px"}})]),J((_(),A(G,{data:ne.value,stripe:"",style:{width:"100%"}},{default:l(()=>[t(d,{prop:"name",label:"功能名称",width:"150"}),t(d,{prop:"description",label:"功能描述","min-width":"250"}),t(d,{prop:"category",label:"功能分类",width:"120"},{default:l(({row:a})=>[t(h,{type:De(a.category),size:"small"},{default:l(()=>[o(i(qe(a.category)),1)]),_:2},1032,["type"])]),_:1}),t(d,{prop:"usage_location",label:"使用位置",width:"150"}),t(d,{label:"当前智能体",width:"200"},{default:l(({row:a})=>[t(D,{modelValue:a.assigned_agent_id,"onUpdate:modelValue":g=>a.assigned_agent_id=g,placeholder:"选择智能体",clearable:"",style:{width:"100%"},onChange:g=>n.updateFunctionAgent(a)},{default:l(()=>[(_(!0),k(me,null,_e(ve.value,g=>(_(),A(y,{key:g.id,label:g.name,value:g.id},{default:l(()=>[s("div",zt,[s("span",null,i(g.name),1),t(h,{type:be(g.provider),size:"small"},{default:l(()=>[o(i(re(g.provider)),1)]),_:2},1032,["type"])])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(d,{label:"状态",width:"80"},{default:l(({row:a})=>[t(h,{type:a.is_active?"success":"warning",size:"small"},{default:l(()=>[o(i(a.assigned_agent_id?"已配置":"未配置"),1)]),_:2},1032,["type"])]),_:1}),t(d,{label:"操作",width:"120",fixed:"right"},{default:l(({row:a})=>[t(r,{type:"text",size:"small",onClick:g=>Ke(a),disabled:!a.assigned_agent_id},{default:l(()=>[...e[43]||(e[43]=[o(" 测试 ",-1)])]),_:1},8,["onClick","disabled"])]),_:1})]),_:1},8,["data"])),[[Y,se.value]])]),_:1})]),_:1}),t(H,{label:"调用日志",name:"logs"},{default:l(()=>[t(f,{class:"content-card"},{header:l(()=>[s("div",At,[e[45]||(e[45]=s("span",null,"调用日志",-1)),s("div",Ft,[t(D,{modelValue:S.function_id,"onUpdate:modelValue":e[0]||(e[0]=a=>S.function_id=a),placeholder:"选择AI功能",clearable:"",style:{width:"200px","margin-right":"10px"},onChange:I},{default:l(()=>[(_(!0),k(me,null,_e(le.value,a=>(_(),A(y,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(D,{modelValue:S.status,"onUpdate:modelValue":e[1]||(e[1]=a=>S.status=a),placeholder:"选择状态",clearable:"",style:{width:"120px","margin-right":"10px"},onChange:I},{default:l(()=>[t(y,{label:"成功",value:"success"}),t(y,{label:"失败",value:"failed"}),t(y,{label:"进行中",value:"pending"})]),_:1},8,["modelValue"]),t(r,{icon:C(Ae),onClick:I},{default:l(()=>[...e[44]||(e[44]=[o("刷新",-1)])]),_:1},8,["icon"])])])]),default:l(()=>[J((_(),A(G,{data:ge.value,stripe:"",style:{width:"100%"}},{default:l(()=>[t(d,{prop:"created_at",label:"调用时间",width:"180"},{default:l(({row:a})=>[o(i(C(P)(a.created_at)),1)]),_:1}),t(d,{prop:"function_name",label:"AI功能",width:"150"}),t(d,{prop:"user_name",label:"调用用户",width:"120"}),t(d,{label:"输入内容","min-width":"200"},{default:l(({row:a})=>[t(Xe,{content:a.input_text,placement:"top"},{default:l(()=>[s("span",Tt,i(a.input_text),1)]),_:2},1032,["content"])]),_:1}),t(d,{label:"状态",width:"80"},{default:l(({row:a})=>[t(h,{type:we(a.status),size:"small"},{default:l(()=>[o(i(ye(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(d,{prop:"tokens_used",label:"Token消耗",width:"100"}),t(d,{label:"响应时间",width:"100"},{default:l(({row:a})=>[a.completed_at&&a.created_at?(_(),k("span",Ut,i(Be(a.created_at,a.completed_at))+"ms ",1)):(_(),k("span",$t,"-"))]),_:1}),t(d,{label:"操作",width:"120",fixed:"right"},{default:l(({row:a})=>[t(r,{type:"text",size:"small",onClick:g=>Je(a)},{default:l(()=>[...e[46]||(e[46]=[o(" 详情 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Y,ee.value]]),s("div",It,[t(Ze,{"current-page":z.page,"onUpdate:currentPage":e[2]||(e[2]=a=>z.page=a),"page-size":z.size,"onUpdate:pageSize":e[3]||(e[3]=a=>z.size=a),total:z.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:I,onCurrentChange:I},null,8,["current-page","page-size","total"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Q,{modelValue:U.value,"onUpdate:modelValue":e[14]||(e[14]=a=>U.value=a),title:B.value?"编辑智能体":"新增智能体",width:"700px"},{footer:l(()=>[t(r,{onClick:e[13]||(e[13]=a=>U.value=!1)},{default:l(()=>[...e[47]||(e[47]=[o("取消",-1)])]),_:1}),t(r,{type:"primary",onClick:Oe,loading:T.value},{default:l(()=>[...e[48]||(e[48]=[o(" 确定 ",-1)])]),_:1},8,["loading"])]),default:l(()=>[t(ce,{ref_key:"agentFormRef",ref:ie,model:p,rules:Fe,"label-width":"120px"},{default:l(()=>[t(w,{label:"智能体名称",prop:"name"},{default:l(()=>[t(F,{modelValue:p.name,"onUpdate:modelValue":e[5]||(e[5]=a=>p.name=a),placeholder:"请输入智能体名称"},null,8,["modelValue"])]),_:1}),t(w,{label:"描述",prop:"description"},{default:l(()=>[t(F,{modelValue:p.description,"onUpdate:modelValue":e[6]||(e[6]=a=>p.description=a),type:"textarea",rows:3,placeholder:"请输入智能体描述"},null,8,["modelValue"])]),_:1}),t(w,{label:"模型提供商",prop:"provider"},{default:l(()=>[t(D,{modelValue:p.provider,"onUpdate:modelValue":e[7]||(e[7]=a=>p.provider=a),style:{width:"100%"}},{default:l(()=>[t(y,{label:"OpenAI",value:"openai"}),t(y,{label:"Claude",value:"claude"}),t(y,{label:"Gemini",value:"gemini"}),t(y,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1}),t(w,{label:"模型名称",prop:"model_name"},{default:l(()=>[t(F,{modelValue:p.model_name,"onUpdate:modelValue":e[8]||(e[8]=a=>p.model_name=a),placeholder:"例如: gpt-4, claude-3-sonnet"},null,8,["modelValue"])]),_:1}),t(w,{label:"系统提示词",prop:"system_prompt"},{default:l(()=>[t(F,{modelValue:p.system_prompt,"onUpdate:modelValue":e[9]||(e[9]=a=>p.system_prompt=a),type:"textarea",rows:6,placeholder:"请输入系统提示词，定义智能体的角色和行为"},null,8,["modelValue"])]),_:1}),t(tt,{gutter:20},{default:l(()=>[t(ke,{span:12},{default:l(()=>[t(w,{label:"温度",prop:"temperature"},{default:l(()=>[t(xe,{modelValue:p.temperature,"onUpdate:modelValue":e[10]||(e[10]=a=>p.temperature=a),min:0,max:2,step:.1,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(ke,{span:12},{default:l(()=>[t(w,{label:"最大Token",prop:"max_tokens"},{default:l(()=>[t(xe,{modelValue:p.max_tokens,"onUpdate:modelValue":e[11]||(e[11]=a=>p.max_tokens=a),min:1,max:32e3,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(w,{label:"状态"},{default:l(()=>[t(he,{modelValue:p.is_active,"onUpdate:modelValue":e[12]||(e[12]=a=>p.is_active=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(Q,{modelValue:$.value,"onUpdate:modelValue":e[21]||(e[21]=a=>$.value=a),title:L.value?"编辑AI功能":"新增AI功能",width:"600px"},{footer:l(()=>[t(r,{onClick:e[20]||(e[20]=a=>$.value=!1)},{default:l(()=>[...e[49]||(e[49]=[o("取消",-1)])]),_:1}),t(r,{type:"primary",onClick:He,loading:T.value},{default:l(()=>[...e[50]||(e[50]=[o(" 确定 ",-1)])]),_:1},8,["loading"])]),default:l(()=>[t(ce,{ref_key:"functionFormRef",ref:de,model:v,rules:Te,"label-width":"120px"},{default:l(()=>[t(w,{label:"功能名称",prop:"name"},{default:l(()=>[t(F,{modelValue:v.name,"onUpdate:modelValue":e[15]||(e[15]=a=>v.name=a),placeholder:"请输入功能名称"},null,8,["modelValue"])]),_:1}),t(w,{label:"描述",prop:"description"},{default:l(()=>[t(F,{modelValue:v.description,"onUpdate:modelValue":e[16]||(e[16]=a=>v.description=a),type:"textarea",rows:3,placeholder:"请输入功能描述"},null,8,["modelValue"])]),_:1}),t(w,{label:"功能类型",prop:"function_type"},{default:l(()=>[t(D,{modelValue:v.function_type,"onUpdate:modelValue":e[17]||(e[17]=a=>v.function_type=a),style:{width:"100%"}},{default:l(()=>[t(y,{label:"文本生成",value:"text_generation"}),t(y,{label:"文本分析",value:"text_analysis"}),t(y,{label:"翻译",value:"translation"}),t(y,{label:"摘要",value:"summarization"}),t(y,{label:"问答",value:"qa"}),t(y,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1}),t(w,{label:"关联智能体",prop:"agent_id"},{default:l(()=>[t(D,{modelValue:v.agent_id,"onUpdate:modelValue":e[18]||(e[18]=a=>v.agent_id=a),style:{width:"100%"},clearable:""},{default:l(()=>[(_(!0),k(me,null,_e(ve.value,a=>(_(),A(y,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(w,{label:"状态"},{default:l(()=>[t(he,{modelValue:v.is_active,"onUpdate:modelValue":e[19]||(e[19]=a=>v.is_active=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(Q,{modelValue:oe.value,"onUpdate:modelValue":e[22]||(e[22]=a=>oe.value=a),title:"调用详情",width:"800px"},{default:l(()=>[b.value?(_(),k("div",Dt,[t(at,{column:2,border:""},{default:l(()=>[t(q,{label:"调用时间"},{default:l(()=>[o(i(C(P)(b.value.created_at)),1)]),_:1}),t(q,{label:"完成时间"},{default:l(()=>[o(i(b.value.completed_at?C(P)(b.value.completed_at):"-"),1)]),_:1}),t(q,{label:"AI功能"},{default:l(()=>[o(i(b.value.function_name),1)]),_:1}),t(q,{label:"调用用户"},{default:l(()=>[o(i(b.value.user_name),1)]),_:1}),t(q,{label:"状态"},{default:l(()=>[t(h,{type:we(b.value.status),size:"small"},{default:l(()=>[o(i(ye(b.value.status)),1)]),_:1},8,["type"])]),_:1}),t(q,{label:"Token消耗"},{default:l(()=>[o(i(b.value.tokens_used||"-"),1)]),_:1})]),_:1}),s("div",qt,[e[52]||(e[52]=s("h4",null,"输入内容：",-1)),s("div",Bt,i(b.value.input_text),1),e[53]||(e[53]=s("h4",null,"输出内容：",-1)),s("div",Lt,i(b.value.output_text||"无输出内容"),1),b.value.error_message?(_(),k("div",St,[e[51]||(e[51]=s("h4",null,"错误信息：",-1)),s("div",Rt,i(b.value.error_message),1)])):K("",!0)])])):K("",!0)]),_:1},8,["modelValue"]),t(Q,{modelValue:N.value,"onUpdate:modelValue":e[25]||(e[25]=a=>N.value=a),title:"测试AI功能",width:"600px"},{footer:l(()=>[t(r,{onClick:e[24]||(e[24]=a=>N.value=!1)},{default:l(()=>[...e[57]||(e[57]=[o("关闭",-1)])]),_:1}),t(r,{type:"primary",onClick:Ye,loading:te.value},{default:l(()=>[...e[58]||(e[58]=[o(" 运行测试 ",-1)])]),_:1},8,["loading"])]),default:l(()=>[R.value?(_(),k("div",jt,[s("p",null,[e[54]||(e[54]=s("strong",null,"功能：",-1)),o(i(R.value.name),1)]),s("p",null,[e[55]||(e[55]=s("strong",null,"描述：",-1)),o(i(R.value.description),1)]),t(ce,null,{default:l(()=>[t(w,{label:"测试输入"},{default:l(()=>[t(F,{modelValue:j.value,"onUpdate:modelValue":e[23]||(e[23]=a=>j.value=a),type:"textarea",rows:4,placeholder:"请输入测试内容"},null,8,["modelValue"])]),_:1})]),_:1}),E.value?(_(),k("div",Et,[e[56]||(e[56]=s("h4",null,"测试结果：",-1)),s("div",Ot,i(E.value.output_text),1),s("p",null,[s("small",null,"Token消耗: "+i(E.value.tokens_used),1)])])):K("",!0)])):K("",!0)]),_:1},8,["modelValue"])])}}},Qt=st(Mt,[["__scopeId","data-v-6bf0a766"]]);export{Qt as default};
