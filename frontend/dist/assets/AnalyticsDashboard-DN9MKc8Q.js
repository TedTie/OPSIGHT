import{_ as ne,d as lt,C as ut,e as K,b as Y,w as re,f as ke,h as Z,c as V,o as C,k as x,i as F,q as X,j as A,p as z,F as he,r as me,x as G,a as _,t as T,v as Mt,n as St,s as At,l as Ct,E as ve}from"./index-D85A-Gbf.js";import{b as Re,g as dt,c as ct}from"./date-qiPTsFx8.js";import{ae as Dt,af as Rt,_ as Q,a1 as R,d as It,ag as pt,ah as He,ai as fe,aj as Lt,ak as ht,al as J,am as mt,an as Ge,e as I,ao as kt,ap as Ie,aq as Tt,ar as Vt,U as N,as as se,m as Zt,at as Ot,au as Et,av as Pt,i as vt,T as Nt,aw as ft,L as Ye,ax as zt,G as Fe,ay as Bt,V as Wt,R as ce,az as Kt,aA as Ue,W as Xe,aB as $t,Z as Ht,aC as Gt,aD as Yt,aE as Ft,aF as qe,aG as Ut,P as Xt,aH as qt,a as jt,a6 as Le,a7 as je,a8 as Jt,a9 as Qt,aa as ea,ab as ta,ad as aa,ac as ra}from"./index.esm.min-kMapdwi9.js";var Je="\0_ec_interaction_mutex";function Qe(s,r){return!!na(s)[r]}function na(s){return s[Je]||(s[Je]={})}Dt({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},Rt);var oa=function(s){Q(r,s);function r(e){var t=s.call(this)||this;t._zr=e;var a=R(t._mousedownHandler,t),n=R(t._mousemoveHandler,t),o=R(t._mouseupHandler,t),i=R(t._mousewheelHandler,t),l=R(t._pinchHandler,t);return t.enable=function(u,d){this.disable(),this._opt=It(pt(d)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),u==null&&(u=!0),(u===!0||u==="move"||u==="pan")&&(e.on("mousedown",a),e.on("mousemove",n),e.on("mouseup",o)),(u===!0||u==="scale"||u==="zoom")&&(e.on("mousewheel",i),e.on("pinch",l))},t.disable=function(){e.off("mousedown",a),e.off("mousemove",n),e.off("mouseup",o),e.off("mousewheel",i),e.off("pinch",l)},t}return r.prototype.isDragging=function(){return this._dragging},r.prototype.isPinching=function(){return this._pinching},r.prototype.setPointerChecker=function(e){this.pointerChecker=e},r.prototype.dispose=function(){this.disable()},r.prototype._mousedownHandler=function(e){if(!He(e)){for(var t=e.target;t;){if(t.draggable)return;t=t.__hostTarget||t.parent}var a=e.offsetX,n=e.offsetY;this.pointerChecker&&this.pointerChecker(e,a,n)&&(this._x=a,this._y=n,this._dragging=!0)}},r.prototype._mousemoveHandler=function(e){if(!(!this._dragging||!pe("moveOnMouseMove",e,this._opt)||e.gestureEvent==="pinch"||Qe(this._zr,"globalPan"))){var t=e.offsetX,a=e.offsetY,n=this._x,o=this._y,i=t-n,l=a-o;this._x=t,this._y=a,this._opt.preventDefaultMouseMove&&fe(e.event),_t(this,"pan","moveOnMouseMove",e,{dx:i,dy:l,oldX:n,oldY:o,newX:t,newY:a,isAvailableBehavior:null})}},r.prototype._mouseupHandler=function(e){He(e)||(this._dragging=!1)},r.prototype._mousewheelHandler=function(e){var t=pe("zoomOnMouseWheel",e,this._opt),a=pe("moveOnMouseWheel",e,this._opt),n=e.wheelDelta,o=Math.abs(n),i=e.offsetX,l=e.offsetY;if(!(n===0||!t&&!a)){if(t){var u=o>3?1.4:o>1?1.2:1.1,d=n>0?u:1/u;be(this,"zoom","zoomOnMouseWheel",e,{scale:d,originX:i,originY:l,isAvailableBehavior:null})}if(a){var c=Math.abs(n),v=(n>0?1:-1)*(c>3?.4:c>1?.15:.05);be(this,"scrollMove","moveOnMouseWheel",e,{scrollDelta:v,originX:i,originY:l,isAvailableBehavior:null})}}},r.prototype._pinchHandler=function(e){if(!Qe(this._zr,"globalPan")){var t=e.pinchScale>1?1.1:1/1.1;be(this,"zoom",null,e,{scale:t,originX:e.pinchX,originY:e.pinchY,isAvailableBehavior:null})}},r}(Lt);function be(s,r,e,t,a){s.pointerChecker&&s.pointerChecker(t,a.originX,a.originY)&&(fe(t.event),_t(s,r,e,t,a))}function _t(s,r,e,t,a){a.isAvailableBehavior=R(pe,null,e,t),s.trigger(r,a)}function pe(s,r,e){var t=e[s];return!s||t&&(!ht(t)||r.event[t+"Key"])}function ge(s,r,e,t,a,n){s=s||0;var o=e[1]-e[0];if(a!=null&&(a=te(a,[0,o])),n!=null&&(n=Math.max(n,a??0)),t==="all"){var i=Math.abs(r[1]-r[0]);i=te(i,[0,o]),a=n=te(i,[a,n]),t=0}r[0]=te(r[0],e),r[1]=te(r[1],e);var l=Me(r,t);r[t]+=s;var u=a||0,d=e.slice();l.sign<0?d[0]+=u:d[1]-=u,r[t]=te(r[t],d);var c;return c=Me(r,t),a!=null&&(c.sign!==l.sign||c.span<a)&&(r[1-t]=r[t]+l.sign*a),c=Me(r,t),n!=null&&c.span>n&&(r[1-t]=r[t]+c.sign*n),r}function Me(s,r){var e=s[r]-s[1-r];return{span:Math.abs(e),sign:e>0?-1:e<0?1:r?-1:1}}function te(s,r){return Math.min(r[1]!=null?r[1]:1/0,Math.max(r[0]!=null?r[0]:-1/0,s))}var et=["x","y","radius","angle","single"],ia=["cartesian2d","polar","singleAxis"];function sa(s){var r=s.get("coordinateSystem");return mt(ia,r)>=0}function q(s){return s+"Axis"}function la(s,r){var e=J(),t=[],a=J();s.eachComponent({mainType:"dataZoom",query:r},function(d){a.get(d.uid)||i(d)});var n;do n=!1,s.eachComponent("dataZoom",o);while(n);function o(d){!a.get(d.uid)&&l(d)&&(i(d),n=!0)}function i(d){a.set(d.uid,!0),t.push(d),u(d)}function l(d){var c=!1;return d.eachTargetAxis(function(v,m){var h=e.get(v);h&&h[m]&&(c=!0)}),c}function u(d){d.eachTargetAxis(function(c,v){(e.get(c)||e.set(c,[]))[v]=!0})}return t}function gt(s){var r=s.ecModel,e={infoList:[],infoMap:J()};return s.eachTargetAxis(function(t,a){var n=r.getComponent(q(t),a);if(n){var o=n.getCoordSysModel();if(o){var i=o.uid,l=e.infoMap.get(i);l||(l={model:o,axisModels:[]},e.infoList.push(l),e.infoMap.set(i,l)),l.axisModels.push(n)}}}),e}var Se=function(){function s(){this.indexList=[],this.indexMap=[]}return s.prototype.add=function(r){this.indexMap[r]||(this.indexList.push(r),this.indexMap[r]=!0)},s}(),_e=function(s){Q(r,s);function r(){var e=s!==null&&s.apply(this,arguments)||this;return e.type=r.type,e._autoThrottle=!0,e._noTarget=!0,e._rangePropMode=["percent","percent"],e}return r.prototype.init=function(e,t,a){var n=tt(e);this.settledOption=n,this.mergeDefaultAndTheme(e,a),this._doInit(n)},r.prototype.mergeOption=function(e){var t=tt(e);Ge(this.option,e,!0),Ge(this.settledOption,t,!0),this._doInit(t)},r.prototype._doInit=function(e){var t=this.option;this._setDefaultThrottle(e),this._updateRangeUse(e);var a=this.settledOption;I([["start","startValue"],["end","endValue"]],function(n,o){this._rangePropMode[o]==="value"&&(t[n[0]]=a[n[0]]=null)},this),this._resetTarget()},r.prototype._resetTarget=function(){var e=this.get("orient",!0),t=this._targetAxisInfoMap=J(),a=this._fillSpecifiedTargetAxis(t);a?this._orient=e||this._makeAutoOrientByTargetAxis():(this._orient=e||"horizontal",this._fillAutoTargetAxisByOrient(t,this._orient)),this._noTarget=!0,t.each(function(n){n.indexList.length&&(this._noTarget=!1)},this)},r.prototype._fillSpecifiedTargetAxis=function(e){var t=!1;return I(et,function(a){var n=this.getReferringComponents(q(a),kt);if(n.specified){t=!0;var o=new Se;I(n.models,function(i){o.add(i.componentIndex)}),e.set(a,o)}},this),t},r.prototype._fillAutoTargetAxisByOrient=function(e,t){var a=this.ecModel,n=!0;if(n){var o=t==="vertical"?"y":"x",i=a.findComponents({mainType:o+"Axis"});l(i,o)}if(n){var i=a.findComponents({mainType:"singleAxis",filter:function(d){return d.get("orient",!0)===t}});l(i,"single")}function l(u,d){var c=u[0];if(c){var v=new Se;if(v.add(c.componentIndex),e.set(d,v),n=!1,d==="x"||d==="y"){var m=c.getReferringComponents("grid",Ie).models[0];m&&I(u,function(h){c.componentIndex!==h.componentIndex&&m===h.getReferringComponents("grid",Ie).models[0]&&v.add(h.componentIndex)})}}}n&&I(et,function(u){if(n){var d=a.findComponents({mainType:q(u),filter:function(v){return v.get("type",!0)==="category"}});if(d[0]){var c=new Se;c.add(d[0].componentIndex),e.set(u,c),n=!1}}},this)},r.prototype._makeAutoOrientByTargetAxis=function(){var e;return this.eachTargetAxis(function(t){!e&&(e=t)},this),e==="y"?"vertical":"horizontal"},r.prototype._setDefaultThrottle=function(e){if(e.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var t=this.ecModel.option;this.option.throttle=t.animation&&t.animationDurationUpdate>0?100:20}},r.prototype._updateRangeUse=function(e){var t=this._rangePropMode,a=this.get("rangeMode");I([["start","startValue"],["end","endValue"]],function(n,o){var i=e[n[0]]!=null,l=e[n[1]]!=null;i&&!l?t[o]="percent":!i&&l?t[o]="value":a?t[o]=a[o]:i&&(t[o]="percent")})},r.prototype.noTarget=function(){return this._noTarget},r.prototype.getFirstTargetAxisModel=function(){var e;return this.eachTargetAxis(function(t,a){e==null&&(e=this.ecModel.getComponent(q(t),a))},this),e},r.prototype.eachTargetAxis=function(e,t){this._targetAxisInfoMap.each(function(a,n){I(a.indexList,function(o){e.call(t,n,o)})})},r.prototype.getAxisProxy=function(e,t){var a=this.getAxisModel(e,t);if(a)return a.__dzAxisProxy},r.prototype.getAxisModel=function(e,t){var a=this._targetAxisInfoMap.get(e);if(a&&a.indexMap[t])return this.ecModel.getComponent(q(e),t)},r.prototype.setRawRange=function(e){var t=this.option,a=this.settledOption;I([["start","startValue"],["end","endValue"]],function(n){(e[n[0]]!=null||e[n[1]]!=null)&&(t[n[0]]=a[n[0]]=e[n[0]],t[n[1]]=a[n[1]]=e[n[1]])},this),this._updateRangeUse(e)},r.prototype.setCalculatedRange=function(e){var t=this.option;I(["start","startValue","end","endValue"],function(a){t[a]=e[a]})},r.prototype.getPercentRange=function(){var e=this.findRepresentativeAxisProxy();if(e)return e.getDataPercentWindow()},r.prototype.getValueRange=function(e,t){if(e==null&&t==null){var a=this.findRepresentativeAxisProxy();if(a)return a.getDataValueWindow()}else return this.getAxisProxy(e,t).getDataValueWindow()},r.prototype.findRepresentativeAxisProxy=function(e){if(e)return e.__dzAxisProxy;for(var t,a=this._targetAxisInfoMap.keys(),n=0;n<a.length;n++)for(var o=a[n],i=this._targetAxisInfoMap.get(o),l=0;l<i.indexList.length;l++){var u=this.getAxisProxy(o,i.indexList[l]);if(u.hostedBy(this))return u;t||(t=u)}return t},r.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},r.prototype.getOrient=function(){return this._orient},r.type="dataZoom",r.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],r.defaultOption={z:4,filterMode:"filter",start:0,end:100},r}(Tt);function tt(s){var r={};return I(["start","end","startValue","endValue","throttle"],function(e){s.hasOwnProperty(e)&&(r[e]=s[e])}),r}var yt=function(s){Q(r,s);function r(){var e=s!==null&&s.apply(this,arguments)||this;return e.type=r.type,e}return r.prototype.render=function(e,t,a,n){this.dataZoomModel=e,this.ecModel=t,this.api=a},r.type="dataZoom",r}(Vt),ae=I,at=se,ua=function(){function s(r,e,t,a){this._dimName=r,this._axisIndex=e,this.ecModel=a,this._dataZoomModel=t}return s.prototype.hostedBy=function(r){return this._dataZoomModel===r},s.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},s.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},s.prototype.getTargetSeriesModels=function(){var r=[];return this.ecModel.eachSeries(function(e){if(sa(e)){var t=q(this._dimName),a=e.getReferringComponents(t,Ie).models[0];a&&this._axisIndex===a.componentIndex&&r.push(e)}},this),r},s.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},s.prototype.getMinMaxSpan=function(){return pt(this._minMaxSpan)},s.prototype.calculateDataWindow=function(r){var e=this._dataExtent,t=this.getAxisModel(),a=t.axis.scale,n=this._dataZoomModel.getRangePropMode(),o=[0,100],i=[],l=[],u;ae(["start","end"],function(v,m){var h=r[v],f=r[v+"Value"];n[m]==="percent"?(h==null&&(h=o[m]),f=a.parse(N(h,o,e))):(u=!0,f=f==null?e[m]:a.parse(f),h=N(f,e,o)),l[m]=f==null||isNaN(f)?e[m]:f,i[m]=h==null||isNaN(h)?o[m]:h}),at(l),at(i);var d=this._minMaxSpan;u?c(l,i,e,o,!1):c(i,l,o,e,!0);function c(v,m,h,f,b){var w=b?"Span":"ValueSpan";ge(0,v,h,"all",d["min"+w],d["max"+w]);for(var p=0;p<2;p++)m[p]=N(v[p],h,f,!0),b&&(m[p]=a.parse(m[p]))}return{valueWindow:l,percentWindow:i}},s.prototype.reset=function(r){if(r===this._dataZoomModel){var e=this.getTargetSeriesModels();this._dataExtent=da(this,this._dimName,e),this._updateMinMaxSpan();var t=this.calculateDataWindow(r.settledOption);this._valueWindow=t.valueWindow,this._percentWindow=t.percentWindow,this._setAxisModel()}},s.prototype.filterData=function(r,e){if(r!==this._dataZoomModel)return;var t=this._dimName,a=this.getTargetSeriesModels(),n=r.get("filterMode"),o=this._valueWindow;if(n==="none")return;ae(a,function(l){var u=l.getData(),d=u.mapDimensionsAll(t);if(d.length){if(n==="weakFilter"){var c=u.getStore(),v=Zt(d,function(m){return u.getDimensionIndex(m)},u);u.filterSelf(function(m){for(var h,f,b,w=0;w<d.length;w++){var p=c.get(v[w],m),S=!isNaN(p),g=p<o[0],M=p>o[1];if(S&&!g&&!M)return!0;S&&(b=!0),g&&(h=!0),M&&(f=!0)}return b&&h&&f})}else ae(d,function(m){if(n==="empty")l.setData(u=u.map(m,function(f){return i(f)?f:NaN}));else{var h={};h[m]=o,u.selectRange(h)}});ae(d,function(m){u.setApproximateExtent(o,m)})}});function i(l){return l>=o[0]&&l<=o[1]}},s.prototype._updateMinMaxSpan=function(){var r=this._minMaxSpan={},e=this._dataZoomModel,t=this._dataExtent;ae(["min","max"],function(a){var n=e.get(a+"Span"),o=e.get(a+"ValueSpan");o!=null&&(o=this.getAxisModel().axis.scale.parse(o)),o!=null?n=N(t[0]+o,t,[0,100],!0):n!=null&&(o=N(n,[0,100],t,!0)-t[0]),r[a+"Span"]=n,r[a+"ValueSpan"]=o},this)},s.prototype._setAxisModel=function(){var r=this.getAxisModel(),e=this._percentWindow,t=this._valueWindow;if(e){var a=Ot(t,[0,500]);a=Math.min(a,20);var n=r.axis.scale.rawExtentInfo;e[0]!==0&&n.setDeterminedMinMax("min",+t[0].toFixed(a)),e[1]!==100&&n.setDeterminedMinMax("max",+t[1].toFixed(a)),n.freeze()}},s}();function da(s,r,e){var t=[1/0,-1/0];ae(e,function(o){Et(t,o.getData(),r)});var a=s.getAxisModel(),n=Pt(a.axis.scale,a,t).calculate();return[n.min,n.max]}var ca={getTargetSeries:function(s){function r(a){s.eachComponent("dataZoom",function(n){n.eachTargetAxis(function(o,i){var l=s.getComponent(q(o),i);a(o,i,l,n)})})}r(function(a,n,o,i){o.__dzAxisProxy=null});var e=[];r(function(a,n,o,i){o.__dzAxisProxy||(o.__dzAxisProxy=new ua(a,n,i,s),e.push(o.__dzAxisProxy))});var t=J();return I(e,function(a){I(a.getTargetSeriesModels(),function(n){t.set(n.uid,n)})}),t},overallReset:function(s,r){s.eachComponent("dataZoom",function(e){e.eachTargetAxis(function(t,a){e.getAxisProxy(t,a).reset(e)}),e.eachTargetAxis(function(t,a){e.getAxisProxy(t,a).filterData(e,r)})}),s.eachComponent("dataZoom",function(e){var t=e.findRepresentativeAxisProxy();if(t){var a=t.getDataPercentWindow(),n=t.getDataValueWindow();e.setCalculatedRange({start:a[0],end:a[1],startValue:n[0],endValue:n[1]})}})}};function pa(s){s.registerAction("dataZoom",function(r,e){var t=la(e,r);I(t,function(a){a.setRawRange({start:r.start,end:r.end,startValue:r.startValue,endValue:r.endValue})})})}var rt=!1;function wt(s){rt||(rt=!0,s.registerProcessor(s.PRIORITY.PROCESSOR.FILTER,ca),pa(s),s.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}var ha=function(s){Q(r,s);function r(){var e=s!==null&&s.apply(this,arguments)||this;return e.type=r.type,e}return r.type="dataZoom.inside",r.defaultOption=vt(_e.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),r}(_e),Te=Nt();function ma(s,r,e){Te(s).coordSysRecordMap.each(function(t){var a=t.dataZoomInfoMap.get(r.uid);a&&(a.getRange=e)})}function va(s,r){for(var e=Te(s).coordSysRecordMap,t=e.keys(),a=0;a<t.length;a++){var n=t[a],o=e.get(n),i=o.dataZoomInfoMap;if(i){var l=r.uid,u=i.get(l);u&&(i.removeKey(l),i.keys().length||xt(e,o))}}}function xt(s,r){if(r){s.removeKey(r.model.uid);var e=r.controller;e&&e.dispose()}}function fa(s,r){var e={model:r,containsPoint:Ye(ga,r),dispatchAction:Ye(_a,s),dataZoomInfoMap:null,controller:null},t=e.controller=new oa(s.getZr());return I(["pan","zoom","scrollMove"],function(a){t.on(a,function(n){var o=[];e.dataZoomInfoMap.each(function(i){if(n.isAvailableBehavior(i.model.option)){var l=(i.getRange||{})[a],u=l&&l(i.dzReferCoordSysInfo,e.model.mainType,e.controller,n);!i.model.get("disabled",!0)&&u&&o.push({dataZoomId:i.model.id,start:u[0],end:u[1]})}}),o.length&&e.dispatchAction(o)})}),e}function _a(s,r){s.isDisposed()||s.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:r})}function ga(s,r,e,t){return s.coordinateSystem.containPoint([e,t])}function ya(s){var r,e="type_",t={type_true:2,type_move:1,type_false:0,type_undefined:-1},a=!0;return s.each(function(n){var o=n.model,i=o.get("disabled",!0)?!1:o.get("zoomLock",!0)?"move":!0;t[e+i]>t[e+r]&&(r=i),a=a&&o.get("preventDefaultMouseMove",!0)}),{controlType:r,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!a}}}function wa(s){s.registerProcessor(s.PRIORITY.PROCESSOR.FILTER,function(r,e){var t=Te(e),a=t.coordSysRecordMap||(t.coordSysRecordMap=J());a.each(function(n){n.dataZoomInfoMap=null}),r.eachComponent({mainType:"dataZoom",subType:"inside"},function(n){var o=gt(n);I(o.infoList,function(i){var l=i.model.uid,u=a.get(l)||a.set(l,fa(e,i.model)),d=u.dataZoomInfoMap||(u.dataZoomInfoMap=J());d.set(n.uid,{dzReferCoordSysInfo:i,model:n,getRange:null})})}),a.each(function(n){var o=n.controller,i,l=n.dataZoomInfoMap;if(l){var u=l.keys()[0];u!=null&&(i=l.get(u))}if(!i){xt(a,n);return}var d=ya(l);o.enable(d.controlType,d.opt),o.setPointerChecker(n.containsPoint),ft(n,"dispatchAction",i.model.get("throttle",!0),"fixRate")})})}var xa=function(s){Q(r,s);function r(){var e=s!==null&&s.apply(this,arguments)||this;return e.type="dataZoom.inside",e}return r.prototype.render=function(e,t,a){if(s.prototype.render.apply(this,arguments),e.noTarget()){this._clear();return}this.range=e.getPercentRange(),ma(a,e,{pan:R(Ae.pan,this),zoom:R(Ae.zoom,this),scrollMove:R(Ae.scrollMove,this)})},r.prototype.dispose=function(){this._clear(),s.prototype.dispose.apply(this,arguments)},r.prototype._clear=function(){va(this.api,this.dataZoomModel),this.range=null},r.type="dataZoom.inside",r}(yt),Ae={zoom:function(s,r,e,t){var a=this.range,n=a.slice(),o=s.axisModels[0];if(o){var i=Ce[r](null,[t.originX,t.originY],o,e,s),l=(i.signal>0?i.pixelStart+i.pixelLength-i.pixel:i.pixel-i.pixelStart)/i.pixelLength*(n[1]-n[0])+n[0],u=Math.max(1/t.scale,0);n[0]=(n[0]-l)*u+l,n[1]=(n[1]-l)*u+l;var d=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();if(ge(0,n,[0,100],0,d.minSpan,d.maxSpan),this.range=n,a[0]!==n[0]||a[1]!==n[1])return n}},pan:nt(function(s,r,e,t,a,n){var o=Ce[t]([n.oldX,n.oldY],[n.newX,n.newY],r,a,e);return o.signal*(s[1]-s[0])*o.pixel/o.pixelLength}),scrollMove:nt(function(s,r,e,t,a,n){var o=Ce[t]([0,0],[n.scrollDelta,n.scrollDelta],r,a,e);return o.signal*(s[1]-s[0])*n.scrollDelta})};function nt(s){return function(r,e,t,a){var n=this.range,o=n.slice(),i=r.axisModels[0];if(i){var l=s(o,i,r,e,t,a);if(ge(l,o,[0,100],"all"),this.range=o,n[0]!==o[0]||n[1]!==o[1])return o}}}var Ce={grid:function(s,r,e,t,a){var n=e.axis,o={},i=a.model.coordinateSystem.getRect();return s=s||[0,0],n.dim==="x"?(o.pixel=r[0]-s[0],o.pixelLength=i.width,o.pixelStart=i.x,o.signal=n.inverse?1:-1):(o.pixel=r[1]-s[1],o.pixelLength=i.height,o.pixelStart=i.y,o.signal=n.inverse?-1:1),o},polar:function(s,r,e,t,a){var n=e.axis,o={},i=a.model.coordinateSystem,l=i.getRadiusAxis().getExtent(),u=i.getAngleAxis().getExtent();return s=s?i.pointToCoord(s):[0,0],r=i.pointToCoord(r),e.mainType==="radiusAxis"?(o.pixel=r[0]-s[0],o.pixelLength=l[1]-l[0],o.pixelStart=l[0],o.signal=n.inverse?1:-1):(o.pixel=r[1]-s[1],o.pixelLength=u[1]-u[0],o.pixelStart=u[0],o.signal=n.inverse?-1:1),o},singleAxis:function(s,r,e,t,a){var n=e.axis,o=a.model.coordinateSystem.getRect(),i={};return s=s||[0,0],n.orient==="horizontal"?(i.pixel=r[0]-s[0],i.pixelLength=o.width,i.pixelStart=o.x,i.signal=n.inverse?1:-1):(i.pixel=r[1]-s[1],i.pixelLength=o.height,i.pixelStart=o.y,i.signal=n.inverse?-1:1),i}};function ba(s){wt(s),s.registerComponentModel(ha),s.registerComponentView(xa),wa(s)}var Ma=function(s){Q(r,s);function r(){var e=s!==null&&s.apply(this,arguments)||this;return e.type=r.type,e}return r.type="dataZoom.slider",r.layoutMode="box",r.defaultOption=vt(_e.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:"#d2dbee",borderRadius:3,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#d2dbee",width:.5},areaStyle:{color:"#d2dbee",opacity:.2}},selectedDataBackground:{lineStyle:{color:"#8fb0f7",width:.5},areaStyle:{color:"#8fb0f7",opacity:.2}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:"#fff",borderColor:"#ACB8D1"},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:"#D2DBEE",opacity:.7},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#6E7079"},brushSelect:!0,brushStyle:{color:"rgba(135,175,274,0.15)"},emphasis:{handleLabel:{show:!0},handleStyle:{borderColor:"#8FB0F7"},moveHandleStyle:{color:"#8FB0F7"}}}),r}(_e),oe=ce,ot=7,Sa=1,De=30,Aa=7,ie="horizontal",it="vertical",Ca=5,Da=["line","bar","candlestick","scatter"],Ra={easing:"cubicOut",duration:100,delay:0},Ia=function(s){Q(r,s);function r(){var e=s!==null&&s.apply(this,arguments)||this;return e.type=r.type,e._displayables={},e}return r.prototype.init=function(e,t){this.api=t,this._onBrush=R(this._onBrush,this),this._onBrushEnd=R(this._onBrushEnd,this)},r.prototype.render=function(e,t,a,n){if(s.prototype.render.apply(this,arguments),ft(this,"_dispatchZoomAction",e.get("throttle"),"fixRate"),this._orient=e.getOrient(),e.get("show")===!1){this.group.removeAll();return}if(e.noTarget()){this._clear(),this.group.removeAll();return}(!n||n.type!=="dataZoom"||n.from!==this.uid)&&this._buildView(),this._updateView()},r.prototype.dispose=function(){this._clear(),s.prototype.dispose.apply(this,arguments)},r.prototype._clear=function(){zt(this,"_dispatchZoomAction");var e=this.api.getZr();e.off("mousemove",this._onBrush),e.off("mouseup",this._onBrushEnd)},r.prototype._buildView=function(){var e=this.group;e.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var t=this._displayables.sliderGroup=new Fe;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),e.add(t),this._positionGroup()},r.prototype._resetLocation=function(){var e=this.dataZoomModel,t=this.api,a=e.get("brushSelect"),n=a?Aa:0,o=this._findCoordRect(),i={width:t.getWidth(),height:t.getHeight()},l=this._orient===ie?{right:i.width-o.x-o.width,top:i.height-De-ot-n,width:o.width,height:De}:{right:ot,top:o.y,width:De,height:o.height},u=Bt(e.option);I(["right","top","width","height"],function(c){u[c]==="ph"&&(u[c]=l[c])});var d=Wt(u,i);this._location={x:d.x,y:d.y},this._size=[d.width,d.height],this._orient===it&&this._size.reverse()},r.prototype._positionGroup=function(){var e=this.group,t=this._location,a=this._orient,n=this.dataZoomModel.getFirstTargetAxisModel(),o=n&&n.get("inverse"),i=this._displayables.sliderGroup,l=(this._dataShadowInfo||{}).otherAxisInverse;i.attr(a===ie&&!o?{scaleY:l?1:-1,scaleX:1}:a===ie&&o?{scaleY:l?1:-1,scaleX:-1}:a===it&&!o?{scaleY:l?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:l?-1:1,scaleX:-1,rotation:Math.PI/2});var u=e.getBoundingRect([i]);e.x=t.x-u.x,e.y=t.y-u.y,e.markRedraw()},r.prototype._getViewExtent=function(){return[0,this._size[0]]},r.prototype._renderBackground=function(){var e=this.dataZoomModel,t=this._size,a=this._displayables.sliderGroup,n=e.get("brushSelect");a.add(new oe({silent:!0,shape:{x:0,y:0,width:t[0],height:t[1]},style:{fill:e.get("backgroundColor")},z2:-40}));var o=new oe({shape:{x:0,y:0,width:t[0],height:t[1]},style:{fill:"transparent"},z2:0,onclick:R(this._onClickPanel,this)}),i=this.api.getZr();n?(o.on("mousedown",this._onBrushStart,this),o.cursor="crosshair",i.on("mousemove",this._onBrush),i.on("mouseup",this._onBrushEnd)):(i.off("mousemove",this._onBrush),i.off("mouseup",this._onBrushEnd)),a.add(o)},r.prototype._renderDataShadow=function(){var e=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],!e)return;var t=this._size,a=this._shadowSize||[],n=e.series,o=n.getRawData(),i=n.getShadowDim&&n.getShadowDim(),l=i&&o.getDimensionInfo(i)?n.getShadowDim():e.otherDim;if(l==null)return;var u=this._shadowPolygonPts,d=this._shadowPolylinePts;if(o!==this._shadowData||l!==this._shadowDim||t[0]!==a[0]||t[1]!==a[1]){var c=o.getDataExtent(l),v=(c[1]-c[0])*.3;c=[c[0]-v,c[1]+v];var m=[0,t[1]],h=[0,t[0]],f=[[t[0],0],[0,0]],b=[],w=h[1]/(o.count()-1),p=0,S=Math.round(o.count()/t[0]),g;o.each([l],function(O,E){if(S>0&&E%S){p+=w;return}var P=O==null||isNaN(O)||O==="",j=P?0:N(O,c,m,!0);P&&!g&&E?(f.push([f[f.length-1][0],0]),b.push([b[b.length-1][0],0])):!P&&g&&(f.push([p,0]),b.push([p,0])),f.push([p,j]),b.push([p,j]),p+=w,g=P}),u=this._shadowPolygonPts=f,d=this._shadowPolylinePts=b}this._shadowData=o,this._shadowDim=l,this._shadowSize=[t[0],t[1]];var M=this.dataZoomModel;function y(O){var E=M.getModel(O?"selectedDataBackground":"dataBackground"),P=new Fe,j=new qt({shape:{points:u},segmentIgnoreThreshold:1,style:E.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),le=new jt({shape:{points:d},segmentIgnoreThreshold:1,style:E.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19});return P.add(j),P.add(le),P}for(var L=0;L<3;L++){var $=y(L===1);this._displayables.sliderGroup.add($),this._displayables.dataShadowSegs.push($)}},r.prototype._prepareDataShadowInfo=function(){var e=this.dataZoomModel,t=e.get("showDataShadow");if(t!==!1){var a,n=this.ecModel;return e.eachTargetAxis(function(o,i){var l=e.getAxisProxy(o,i).getTargetSeriesModels();I(l,function(u){if(!a&&!(t!==!0&&mt(Da,u.get("type"))<0)){var d=n.getComponent(q(o),i).axis,c=La(o),v,m=u.coordinateSystem;c!=null&&m.getOtherAxis&&(v=m.getOtherAxis(d).inverse),c=u.getData().mapDimension(c),a={thisAxis:d,series:u,thisDim:o,otherDim:c,otherAxisInverse:v}}},this)},this),a}},r.prototype._renderHandle=function(){var e=this.group,t=this._displayables,a=t.handles=[null,null],n=t.handleLabels=[null,null],o=this._displayables.sliderGroup,i=this._size,l=this.dataZoomModel,u=this.api,d=l.get("borderRadius")||0,c=l.get("brushSelect"),v=t.filler=new oe({silent:c,style:{fill:l.get("fillerColor")},textConfig:{position:"inside"}});o.add(v),o.add(new oe({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:i[0],height:i[1],r:d},style:{stroke:l.get("dataBackgroundColor")||l.get("borderColor"),lineWidth:Sa,fill:"rgba(0,0,0,0)"}})),I([0,1],function(S){var g=l.get("handleIcon");!Kt[g]&&g.indexOf("path://")<0&&g.indexOf("image://")<0&&(g="path://"+g);var M=Ue(g,-1,0,2,2,null,!0);M.attr({cursor:st(this._orient),draggable:!0,drift:R(this._onDragMove,this,S),ondragend:R(this._onDragEnd,this),onmouseover:R(this._showDataInfo,this,!0),onmouseout:R(this._showDataInfo,this,!1),z2:5});var y=M.getBoundingRect(),L=l.get("handleSize");this._handleHeight=Xe(L,this._size[1]),this._handleWidth=y.width/y.height*this._handleHeight,M.setStyle(l.getModel("handleStyle").getItemStyle()),M.style.strokeNoScale=!0,M.rectHover=!0,M.ensureState("emphasis").style=l.getModel(["emphasis","handleStyle"]).getItemStyle(),$t(M);var $=l.get("handleColor");$!=null&&(M.style.fill=$),o.add(a[S]=M);var O=l.getModel("textStyle"),E=l.get("handleLabel")||{},P=E.show||!1;e.add(n[S]=new Ht({silent:!0,invisible:!P,style:Gt(O,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:O.getTextColor(),font:O.getFont()}),z2:10}))},this);var m=v;if(c){var h=Xe(l.get("moveHandleSize"),i[1]),f=t.moveHandle=new ce({style:l.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:i[1]-.5,height:h}}),b=h*.8,w=t.moveHandleIcon=Ue(l.get("moveHandleIcon"),-b/2,-b/2,b,b,"#fff",!0);w.silent=!0,w.y=i[1]+h/2-.5,f.ensureState("emphasis").style=l.getModel(["emphasis","moveHandleStyle"]).getItemStyle();var p=Math.min(i[1]/2,Math.max(h,10));m=t.moveZone=new ce({invisible:!0,shape:{y:i[1]-p,height:h+p}}),m.on("mouseover",function(){u.enterEmphasis(f)}).on("mouseout",function(){u.leaveEmphasis(f)}),o.add(f),o.add(w),o.add(m)}m.attr({draggable:!0,cursor:st(this._orient),drift:R(this._onDragMove,this,"all"),ondragstart:R(this._showDataInfo,this,!0),ondragend:R(this._onDragEnd,this),onmouseover:R(this._showDataInfo,this,!0),onmouseout:R(this._showDataInfo,this,!1)})},r.prototype._resetInterval=function(){var e=this._range=this.dataZoomModel.getPercentRange(),t=this._getViewExtent();this._handleEnds=[N(e[0],[0,100],t,!0),N(e[1],[0,100],t,!0)]},r.prototype._updateInterval=function(e,t){var a=this.dataZoomModel,n=this._handleEnds,o=this._getViewExtent(),i=a.findRepresentativeAxisProxy().getMinMaxSpan(),l=[0,100];ge(t,n,o,a.get("zoomLock")?"all":e,i.minSpan!=null?N(i.minSpan,l,o,!0):null,i.maxSpan!=null?N(i.maxSpan,l,o,!0):null);var u=this._range,d=this._range=se([N(n[0],o,l,!0),N(n[1],o,l,!0)]);return!u||u[0]!==d[0]||u[1]!==d[1]},r.prototype._updateView=function(e){var t=this._displayables,a=this._handleEnds,n=se(a.slice()),o=this._size;I([0,1],function(m){var h=t.handles[m],f=this._handleHeight;h.attr({scaleX:f/2,scaleY:f/2,x:a[m]+(m?-1:1),y:o[1]/2-f/2})},this),t.filler.setShape({x:n[0],y:0,width:n[1]-n[0],height:o[1]});var i={x:n[0],width:n[1]-n[0]};t.moveHandle&&(t.moveHandle.setShape(i),t.moveZone.setShape(i),t.moveZone.getBoundingRect(),t.moveHandleIcon&&t.moveHandleIcon.attr("x",i.x+i.width/2));for(var l=t.dataShadowSegs,u=[0,n[0],n[1],o[0]],d=0;d<l.length;d++){var c=l[d],v=c.getClipPath();v||(v=new ce,c.setClipPath(v)),v.setShape({x:u[d],y:0,width:u[d+1]-u[d],height:o[1]})}this._updateDataInfo(e)},r.prototype._updateDataInfo=function(e){var t=this.dataZoomModel,a=this._displayables,n=a.handleLabels,o=this._orient,i=["",""];if(t.get("showDetail")){var l=t.findRepresentativeAxisProxy();if(l){var u=l.getAxisModel().axis,d=this._range,c=e?l.calculateDataWindow({start:d[0],end:d[1]}).valueWindow:l.getDataValueWindow();i=[this._formatLabel(c[0],u),this._formatLabel(c[1],u)]}}var v=se(this._handleEnds.slice());m.call(this,0),m.call(this,1);function m(h){var f=Yt(a.handles[h].parent,this.group),b=Ft(h===0?"right":"left",f),w=this._handleWidth/2+Ca,p=qe([v[h]+(h===0?-w:w),this._size[1]/2],f);n[h].setStyle({x:p[0],y:p[1],verticalAlign:o===ie?"middle":b,align:o===ie?b:"center",text:i[h]})}},r.prototype._formatLabel=function(e,t){var a=this.dataZoomModel,n=a.get("labelFormatter"),o=a.get("labelPrecision");(o==null||o==="auto")&&(o=t.getPixelPrecision());var i=e==null||isNaN(e)?"":t.type==="category"||t.type==="time"?t.scale.getLabel({value:Math.round(e)}):e.toFixed(Math.min(o,20));return Ut(n)?n(e,i):ht(n)?n.replace("{value}",i):i},r.prototype._showDataInfo=function(e){var t=this.dataZoomModel.get("handleLabel")||{},a=t.show||!1,n=this.dataZoomModel.getModel(["emphasis","handleLabel"]),o=n.get("show")||!1,i=e||this._dragging?o:a,l=this._displayables,u=l.handleLabels;u[0].attr("invisible",!i),u[1].attr("invisible",!i),l.moveHandle&&this.api[i?"enterEmphasis":"leaveEmphasis"](l.moveHandle,1)},r.prototype._onDragMove=function(e,t,a,n){this._dragging=!0,fe(n.event);var o=this._displayables.sliderGroup.getLocalTransform(),i=qe([t,a],o,!0),l=this._updateInterval(e,i[0]),u=this.dataZoomModel.get("realtime");this._updateView(!u),l&&u&&this._dispatchZoomAction(!0)},r.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1);var e=this.dataZoomModel.get("realtime");!e&&this._dispatchZoomAction(!1)},r.prototype._onClickPanel=function(e){var t=this._size,a=this._displayables.sliderGroup.transformCoordToLocal(e.offsetX,e.offsetY);if(!(a[0]<0||a[0]>t[0]||a[1]<0||a[1]>t[1])){var n=this._handleEnds,o=(n[0]+n[1])/2,i=this._updateInterval("all",a[0]-o);this._updateView(),i&&this._dispatchZoomAction(!1)}},r.prototype._onBrushStart=function(e){var t=e.offsetX,a=e.offsetY;this._brushStart=new Xt(t,a),this._brushing=!0,this._brushStartTime=+new Date},r.prototype._onBrushEnd=function(e){if(this._brushing){var t=this._displayables.brushRect;if(this._brushing=!1,!!t){t.attr("ignore",!0);var a=t.shape,n=+new Date;if(!(n-this._brushStartTime<200&&Math.abs(a.width)<5)){var o=this._getViewExtent(),i=[0,100];this._range=se([N(a.x,o,i,!0),N(a.x+a.width,o,i,!0)]),this._handleEnds=[a.x,a.x+a.width],this._updateView(),this._dispatchZoomAction(!1)}}}},r.prototype._onBrush=function(e){this._brushing&&(fe(e.event),this._updateBrushRect(e.offsetX,e.offsetY))},r.prototype._updateBrushRect=function(e,t){var a=this._displayables,n=this.dataZoomModel,o=a.brushRect;o||(o=a.brushRect=new oe({silent:!0,style:n.getModel("brushStyle").getItemStyle()}),a.sliderGroup.add(o)),o.attr("ignore",!1);var i=this._brushStart,l=this._displayables.sliderGroup,u=l.transformCoordToLocal(e,t),d=l.transformCoordToLocal(i.x,i.y),c=this._size;u[0]=Math.max(Math.min(c[0],u[0]),0),o.setShape({x:d[0],y:0,width:u[0]-d[0],height:c[1]})},r.prototype._dispatchZoomAction=function(e){var t=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:e?Ra:null,start:t[0],end:t[1]})},r.prototype._findCoordRect=function(){var e,t=gt(this.dataZoomModel).infoList;if(!e&&t.length){var a=t[0].model.coordinateSystem;e=a.getRect&&a.getRect()}if(!e){var n=this.api.getWidth(),o=this.api.getHeight();e={x:n*.2,y:o*.2,width:n*.6,height:o*.6}}return e},r.type="dataZoom.slider",r}(yt);function La(s){var r={x:"y",y:"x",radius:"angle",angle:"radius"};return r[s]}function st(s){return s==="vertical"?"ns-resize":"ew-resize"}function ka(s){s.registerComponentModel(Ma),s.registerComponentView(Ia),wt(s)}function Ta(s){Le(ba),Le(ka)}const Va={class:"filters-bar"},Za={__name:"FilterBar",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(s,{emit:r}){const e=s,t=r,a=lt(),n=ut({timeRange:e.modelValue.timeRange||"month",dateRange:e.modelValue.dateRange||[],groupId:e.modelValue.groupId||null,role:e.modelValue.role??(a!=null&&a.isSuperAdmin?"ALL":"CC"),userId:e.modelValue.userId||null}),o=K([]),i=K([]),l=Y(()=>n.groupId?i.value.filter(m=>m.group_id===n.groupId):i.value);function u(){t("update:modelValue",{...n})}function d(){if(n.timeRange==="today"){const m=Re();n.dateRange=[m,m]}else n.timeRange==="week"?n.dateRange=dt(new Date):n.timeRange==="month"&&(n.dateRange=ct(new Date));u()}function c(){l.value.some(h=>h.id===n.userId)||(n.userId=null),u()}async function v(){try{const[{data:m},{data:h}]=await Promise.all([G.get("/groups",{params:{page:1,size:100},suppressErrorMessage:!0}),G.get("/users",{params:{page:1,size:100},suppressErrorMessage:!0})]);o.value=Array.isArray(m==null?void 0:m.items)?m.items:[],i.value=Array.isArray(h==null?void 0:h.items)?h.items:[]}catch{o.value=[],i.value=[]}}return re(()=>e.modelValue,m=>{Object.assign(n,m||{})}),ke(()=>{if(!a.user)try{a.initAuth()}catch{}a.isSuperAdmin&&n.role!=="ALL"&&(n.role="ALL",u()),v()}),(m,h)=>{const f=Z("el-radio-button"),b=Z("el-radio-group"),w=Z("el-date-picker"),p=Z("el-option"),S=Z("el-select");return C(),V("div",Va,[x(b,{modelValue:n.timeRange,"onUpdate:modelValue":h[0]||(h[0]=g=>n.timeRange=g),onChange:d},{default:A(()=>[x(f,{label:"today"},{default:A(()=>[...h[5]||(h[5]=[z("‰ªäÊó•",-1)])]),_:1}),x(f,{label:"week"},{default:A(()=>[...h[6]||(h[6]=[z("Êú¨Âë®",-1)])]),_:1}),x(f,{label:"month"},{default:A(()=>[...h[7]||(h[7]=[z("Êú¨Êúà",-1)])]),_:1}),x(f,{label:"custom"},{default:A(()=>[...h[8]||(h[8]=[z("Ëá™ÂÆö‰πâ",-1)])]),_:1})]),_:1},8,["modelValue"]),n.timeRange==="custom"?(C(),F(w,{key:0,modelValue:n.dateRange,"onUpdate:modelValue":h[1]||(h[1]=g=>n.dateRange=g),type:"daterange","range-separator":"Ëá≥","start-placeholder":"ÂºÄÂßãÊó•Êúü","end-placeholder":"ÁªìÊùüÊó•Êúü",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:u},null,8,["modelValue"])):X("",!0),x(S,{modelValue:n.role,"onUpdate:modelValue":h[2]||(h[2]=g=>n.role=g),placeholder:"ËßÜËßí",style:{width:"160px"},onChange:u},{default:A(()=>[x(p,{label:"CC(È°æÈóÆ)",value:"CC"}),x(p,{label:"SS(Áè≠‰∏ª‰ªª)",value:"SS"}),x(p,{label:"LP(Ëã±ÊñáËæÖÂØº)",value:"LP"}),x(p,{label:"ÂÖ®‰Ωì",value:"ALL"})]),_:1},8,["modelValue"]),x(S,{modelValue:n.groupId,"onUpdate:modelValue":h[3]||(h[3]=g=>n.groupId=g),placeholder:"ÁªÑÁªá",clearable:"",style:{width:"200px"},onChange:c},{default:A(()=>[x(p,{label:"ÂÖ®ÈÉ®ÁªÑÁªá",value:null}),(C(!0),V(he,null,me(o.value,g=>(C(),F(p,{key:g.id,label:g.name,value:g.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),x(S,{modelValue:n.userId,"onUpdate:modelValue":h[4]||(h[4]=g=>n.userId=g),placeholder:"Áî®Êà∑",clearable:"",filterable:"",style:{width:"220px"},onChange:u},{default:A(()=>[x(p,{label:"ÂÖ®ÈÉ®Áî®Êà∑",value:null}),(C(!0),V(he,null,me(l.value,g=>(C(),F(p,{key:g.id,label:g.username,value:g.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])}}},Oa=ne(Za,[["__scopeId","data-v-7b4a5060"]]),Ea={class:"card-top"},Pa={class:"title"},Na={class:"value"},za={key:0,class:"unit"},Ba={__name:"DataCard",props:{title:{type:String,required:!0},value:{type:[Number,String],default:0},unit:{type:String,default:""},metricKey:{type:String,required:!0},isActive:{type:Boolean,default:!1}},emits:["cardClick","aiClick"],setup(s,{emit:r}){const e=s,t=r,a=Y(()=>e.value===null||e.value===void 0||e.value===""?"‚Äî":typeof e.value=="number"&&typeof e.unit=="string"&&e.unit.includes("USD")?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(e.value):typeof e.value=="number"?e.value.toLocaleString():e.value);function n(){t("cardClick",e.metricKey)}const o=K({});function i(u){const d=u.currentTarget.getBoundingClientRect(),c=u.clientX-d.left,v=u.clientY-d.top;o.value={"--mouse-x":`${c}px`,"--mouse-y":`${v}px`}}function l(){o.value={}}return(u,d)=>{const c=Z("el-button"),v=Z("el-card");return C(),F(v,{class:At(["data-card hover-effect",{active:s.isActive}]),onClick:n,onMousemove:i,onMouseleave:l,style:St(o.value)},{default:A(()=>[_("div",Ea,[_("div",Pa,T(s.title),1),x(c,{text:"",type:"primary",onClick:d[0]||(d[0]=Mt(m=>t("aiClick",s.metricKey),["stop"]))},{default:A(()=>[...d[1]||(d[1]=[z("AIÊ¥ûÂØü",-1)])]),_:1})]),_("div",Na,T(a.value),1),s.unit?(C(),V("div",za,T(s.unit),1)):X("",!0)]),_:1},8,["class","style"])}}},Wa=ne(Ba,[["__scopeId","data-v-68eff4ff"]]),Ka={class:"grid-container"},$a={key:0,class:"empty"},Ha={key:1,class:"grid"},Ga={__name:"CardGrid",props:{summaryData:{type:Object,required:!0},activeMetricKey:{type:String,default:""},visibleKeys:{type:Array,default:()=>[]}},emits:["cardClick","aiClick"],setup(s,{emit:r}){const e=s,t=r,a={task_completion_rate:{name:"‰ªªÂä°ÂÆåÊàêÁéá",unit:"%"},period_sales_amount:{name:"ÈîÄÂîÆÊÄªÈ¢ù",unit:"USD"},sales_achievement_rate:{name:"ÈîÄÂîÆÁõÆÊ†áËææÊàêÁéá",unit:"%"},period_new_sign_amount:{name:"Êñ∞ÂçïÈáëÈ¢ù",unit:"USD"},new_sign_count:{name:"Êñ∞ÂçïÂçïÈáè",unit:"Âçï"},new_sign_achievement_rate:{name:"Êñ∞ÂçïÁõÆÊ†áËææÊàêÁéá",unit:"%"},period_referral_amount:{name:"ËΩ¨‰ªãÁªçÈáëÈ¢ù",unit:"USD"},referral_count:{name:"ËΩ¨‰ªãÁªçÂçïÈáè",unit:"Âçï"},referral_achievement_rate:{name:"ËΩ¨‰ªãÁªçÁõÆÊ†áËææÊàêÁéá",unit:"%"},period_total_renewal_amount:{name:"ÊÄªÁª≠Ë¥πÈáëÈ¢ù",unit:"USD"},total_renewal_achievement_rate:{name:"ÊÄªÁª≠Ë¥πÁõÆÊ†áËææÊàêÁéá",unit:"%"},period_upgrade_amount:{name:"ÂçáËà±ÈáëÈ¢ù",unit:"USD"},upgrade_count:{name:"ÂçáËà±ÂçïÈáè",unit:"Âçï"},upgrade_rate:{name:"ÂçáËà±Áéá",unit:"%"},report_submission_rate:{name:"Êó•Êä•Êèê‰∫§Áéá",unit:"%"}},n=Y(()=>{const o=Object.keys(e.summaryData||{});return e.visibleKeys&&e.visibleKeys.length>0?e.visibleKeys.filter(i=>o.includes(i)):o});return(o,i)=>{const l=Z("el-card");return C(),V("div",Ka,[x(l,{class:"content-card",shadow:"never"},{header:A(()=>[...i[0]||(i[0]=[_("div",{class:"card-header"},[_("span",null,"ÊåáÊ†áÊ¶ÇËßà")],-1)])]),default:A(()=>[n.value.length===0?(C(),V("div",$a,"ÊöÇÊó†Êï∞ÊçÆ")):(C(),V("div",Ha,[(C(!0),V(he,null,me(n.value,u=>{var d,c;return C(),F(Wa,{key:u,metricKey:u,title:((d=a[u])==null?void 0:d.name)||u,unit:((c=a[u])==null?void 0:c.unit)||"",value:s.summaryData[u],isActive:s.activeMetricKey===u,onCardClick:v=>t("cardClick",u),onAiClick:v=>t("aiClick",u)},null,8,["metricKey","title","unit","value","isActive","onCardClick","onAiClick"])}),128))]))]),_:1})])}}},Ya=ne(Ga,[["__scopeId","data-v-869ff2dd"]]),Fa={class:"trend-module"},Ua={key:0,class:"empty"},Xa={key:1},qa={class:"toolbar"},ja=Object.assign({name:"TrendChartModule",components:{"v-chart":je}},{__name:"TrendChartModule",props:{metricKey:{type:String,default:""},filterParams:{type:Object,required:!0}},setup(s){Le([Jt,Qt,ea,ta,aa,Ta,ra]);const r=s,e=K(!1),t=K([]);async function a(){var o,i,l,u;if(r.metricKey){e.value=!0;try{const[d,c]=((o=r.filterParams)==null?void 0:o.dateRange)||[],v=((i=r.filterParams)==null?void 0:i.role)||"CC",m=v==="CC",h=v==="SS";let f=[];if(r.metricKey==="period_sales_amount")f=m?["new_sign_amount","referral_amount"]:h?["renewal_amount","upgrade_amount"]:["new_sign_amount","referral_amount","renewal_amount","upgrade_amount"];else if(r.metricKey==="period_new_sign_amount")f=["new_sign_amount"];else if(r.metricKey==="period_referral_amount")f=["referral_amount"];else if(r.metricKey==="period_renewal_amount")f=["renewal_amount"];else if(r.metricKey==="period_upgrade_amount")f=["upgrade_amount"];else if(r.metricKey==="period_total_renewal_amount")f=["renewal_amount","upgrade_amount"];else if(r.metricKey==="referral_count")f=["referral_count"];else if(r.metricKey==="renewal_count")f=["renewal_count"];else if(r.metricKey==="upgrade_count")f=["upgrade_count"];else{t.value=[],e.value=!1;return}const b=m?"CC":h?"SS":void 0,{data:w}=await G.get("/analytics/trend",{params:{start_date:d,end_date:c,identity_type:b,metrics:f,group_id:((l=r.filterParams)==null?void 0:l.groupId)||void 0,user_id:((u=r.filterParams)==null?void 0:u.userId)||void 0}}),p=(w==null?void 0:w.series)||[];t.value=p.map(S=>{const g=(()=>{if(r.metricKey==="period_sales_amount"){const L=Number(S.new_sign_amount||0),$=Number(S.referral_amount||0),O=Number(S.renewal_amount||0),E=Number(S.upgrade_amount||0);return L+$+O+E}if(r.metricKey==="period_total_renewal_amount"){const L=Number(S.renewal_amount||0),$=Number(S.upgrade_amount||0);return L+$}const y={period_new_sign_amount:"new_sign_amount",period_referral_amount:"referral_amount",period_renewal_amount:"renewal_amount",period_upgrade_amount:"upgrade_amount",referral_count:"referral_count",renewal_count:"renewal_count",upgrade_count:"upgrade_count"}[r.metricKey];return Number(S[y]||0)})();return{date:S.date,value:g}})}catch{ve.error("Ëé∑ÂèñË∂ãÂäøÊï∞ÊçÆÂ§±Ë¥•")}finally{e.value=!1}}}re(()=>r.metricKey,()=>{a()}),re(()=>r.filterParams,()=>{a()},{deep:!0});const n=Y(()=>{const o=t.value.map(l=>l.date),i=t.value.map(l=>l.value);return{title:{text:"ÊåáÊ†áË∂ãÂäø"},tooltip:{trigger:"axis"},grid:{left:40,right:20,bottom:60},dataZoom:[{type:"inside"},{type:"slider"}],xAxis:{type:"category",data:o},yAxis:{type:"value"},legend:{data:["ÂÄº"]},series:[{name:"ÂÄº",type:"line",data:i,smooth:!0}]}});return(o,i)=>{const l=Z("el-button");return C(),V("div",Fa,[s.metricKey?(C(),V("div",Xa,[_("div",qa,[x(l,{size:"small",loading:e.value,onClick:a},{default:A(()=>[...i[0]||(i[0]=[z("Âà∑Êñ∞Ë∂ãÂäø",-1)])]),_:1},8,["loading"])]),x(Ct(je),{class:"chart",option:n.value,autoresize:""},null,8,["option"])])):(C(),V("div",Ua,"ËØ∑ÈÄâÊã©‰∏Ä‰∏™ÊåáÊ†áÊü•ÁúãË∂ãÂäø"))])}}}),Ja=ne(ja,[["__scopeId","data-v-f63e1247"]]),Qa={class:"ranking-container"},er={class:"header-row"},tr={key:1,class:"ranking-content"},ar={class:"podium-wrap"},rr={class:"podium"},nr={key:0,class:"podium-item second"},or={class:"avatar-wrap"},ir=["title"],sr={class:"podium-value"},lr={key:1,class:"podium-item first"},ur={class:"avatar-wrap"},dr=["title"],cr={class:"podium-value"},pr={key:2,class:"podium-item third"},hr={class:"avatar-wrap"},mr=["title"],vr={class:"podium-value"},fr={class:"rank-list"},_r={class:"rank-num"},gr=["title"],yr={class:"row-value"},wr={class:"card-header"},xr={class:"my-rank-row"},br={class:"user-cell"},Mr={class:"name"},Sr={class:"value"},Ar={__name:"RankingList",props:{metricKey:{type:String,default:""},filterParams:{type:Object,required:!0}},setup(s){const r=s,e=K(!1),t=K([]),a=K(null),n={task_completion_rate:{name:"‰ªªÂä°ÂÆåÊàêÁéá"},period_sales_amount:{name:"ÈîÄÂîÆÊÄªÈ¢ù"},sales_achievement_rate:{name:"ÈîÄÂîÆÁõÆÊ†áËææÊàêÁéá"},period_new_sign_amount:{name:"Êñ∞ÂçïÈáëÈ¢ù"},new_sign_count:{name:"Êñ∞ÂçïÂçïÈáè"},new_sign_achievement_rate:{name:"Êñ∞ÂçïÁõÆÊ†áËææÊàêÁéá"},period_referral_amount:{name:"ËΩ¨‰ªãÁªçÈáëÈ¢ù"},referral_count:{name:"ËΩ¨‰ªãÁªçÂçïÈáè"},referral_achievement_rate:{name:"ËΩ¨‰ªãÁªçÁõÆÊ†áËææÊàêÁéá"},period_total_renewal_amount:{name:"ÊÄªÁª≠Ë¥πÈáëÈ¢ù"},total_renewal_achievement_rate:{name:"ÊÄªÁª≠Ë¥πÁõÆÊ†áËææÊàêÁéá"},period_upgrade_amount:{name:"ÂçáËà±ÈáëÈ¢ù"},upgrade_count:{name:"ÂçáËà±ÂçïÈáè"},upgrade_rate:{name:"ÂçáËà±Áéá"},report_submission_rate:{name:"Êó•Êä•Êèê‰∫§Áéá"}},o=Y(()=>{var c;return((c=n[r.metricKey])==null?void 0:c.name)||r.metricKey}),i=Y(()=>{var v;const c=(v=a.value)==null?void 0:v.user_id;return!c||!Array.isArray(t.value)?!1:t.value.some(m=>m.user_id===c)});async function l(){var c,v,m,h;if(!r.metricKey){t.value=[],a.value=null;return}e.value=!0;try{const[f,b]=((c=r.filterParams)==null?void 0:c.dateRange)||[],w={metric_key:r.metricKey,start_date:f,end_date:b,group_id:((v=r.filterParams)==null?void 0:v.groupId)||void 0,user_id:((m=r.filterParams)==null?void 0:m.userId)||void 0,role_scope:((h=r.filterParams)==null?void 0:h.role)||void 0},{data:p}=await G.get("/analytics/ranking",{params:w,suppressErrorMessage:!0}),S=Array.isArray(p==null?void 0:p.top_10)?p.top_10:[];t.value=S,a.value=(p==null?void 0:p.current_user_rank)||null}catch{ve.warning("Ëé∑ÂèñÊéíË°åÊ¶úÂ§±Ë¥•"),t.value=[],a.value=null}finally{e.value=!1}}re(()=>r.metricKey,()=>{l()}),re(()=>r.filterParams,()=>{l()},{deep:!0}),ke(()=>{l()});const u=Y(()=>Array.isArray(t.value)?t.value.slice(0,3):[]),d=Y(()=>Array.isArray(t.value)?t.value.slice(3):[]);return(c,v)=>{const m=Z("el-tag"),h=Z("el-button"),f=Z("el-empty"),b=Z("el-avatar"),w=Z("el-card");return C(),V("div",Qa,[_("div",er,[v[1]||(v[1]=_("span",{class:"title"},"ÊéíË°åÊ¶ú",-1)),s.metricKey?(C(),F(m,{key:0,type:"primary",size:"small"},{default:A(()=>[z("ÊåáÊ†áÔºö"+T(o.value),1)]),_:1})):X("",!0),x(h,{class:"refresh-btn",loading:e.value,onClick:l},{default:A(()=>[...v[0]||(v[0]=[z("Âà∑Êñ∞",-1)])]),_:1},8,["loading"])]),!e.value&&(!t.value||t.value.length===0)?(C(),F(f,{key:0,description:"ÊöÇÊó†ÊéíÂêçÊï∞ÊçÆ"})):(C(),V("div",tr,[_("div",ar,[v[5]||(v[5]=_("div",{class:"podium-banner"},null,-1)),_("div",rr,[u.value[1]?(C(),V("div",nr,[_("div",or,[x(b,{size:68,src:u.value[1].avatar},null,8,["src"]),v[2]||(v[2]=_("span",{class:"medal medal-silver","aria-hidden":"true"},"ü•à",-1))]),_("div",{class:"podium-name",title:u.value[1].name||"‚Äî"},T(u.value[1].name||"‚Äî"),9,ir),_("div",sr,T(u.value[1].formatted_value??u.value[1].value??"‚Äî"),1)])):X("",!0),u.value[0]?(C(),V("div",lr,[_("div",ur,[x(b,{size:88,src:u.value[0].avatar},null,8,["src"]),v[3]||(v[3]=_("span",{class:"medal medal-gold","aria-hidden":"true"},"ü•á",-1))]),_("div",{class:"podium-name",title:u.value[0].name||"‚Äî"},T(u.value[0].name||"‚Äî"),9,dr),_("div",cr,T(u.value[0].formatted_value??u.value[0].value??"‚Äî"),1)])):X("",!0),u.value[2]?(C(),V("div",pr,[_("div",hr,[x(b,{size:68,src:u.value[2].avatar},null,8,["src"]),v[4]||(v[4]=_("span",{class:"medal medal-bronze","aria-hidden":"true"},"ü•â",-1))]),_("div",{class:"podium-name",title:u.value[2].name||"‚Äî"},T(u.value[2].name||"‚Äî"),9,mr),_("div",vr,T(u.value[2].formatted_value??u.value[2].value??"‚Äî"),1)])):X("",!0)])]),_("div",fr,[(C(!0),V(he,null,me(d.value,p=>(C(),V("div",{key:p.user_id||p.rank,class:"rank-row"},[_("div",_r,T(p.rank),1),x(b,{size:36,src:p.avatar},null,8,["src"]),_("div",{class:"row-name",title:p.name||"‚Äî"},T(p.name||"‚Äî"),9,gr),_("div",yr,T(p.formatted_value??p.value??"‚Äî"),1)]))),128))])])),a.value&&!i.value?(C(),F(w,{key:2,class:"my-rank-card",shadow:"never"},{header:A(()=>[_("div",wr,[v[7]||(v[7]=_("span",null,"ÊàëÁöÑÊéíÂêç",-1)),x(m,{type:"success",size:"small"},{default:A(()=>[...v[6]||(v[6]=[z("‰∏çÂú®Top10ÔºåÂçïÁã¨ÊòæÁ§∫",-1)])]),_:1})])]),default:A(()=>[_("div",xr,[x(m,{size:"small"},{default:A(()=>[z("Á¨¨ "+T(a.value.rank)+" Âêç",1)]),_:1}),_("div",br,[x(b,{size:28,src:a.value.avatar},null,8,["src"]),_("span",Mr,T(a.value.name||"‚Äî"),1)]),_("span",Sr,T(a.value.formatted_value??a.value.value??"‚Äî"),1)])]),_:1})):X("",!0)])}}},Cr=ne(Ar,[["__scopeId","data-v-1f8d4dc3"]]),Dr={class:"page-container"},Rr={class:"card-header"},Ir={class:"header-actions"},Lr={class:"card-header"},kr={class:"header-actions"},Tr={class:"card-header"},Vr={class:"header-actions"},Zr={style:{"white-space":"pre-wrap","min-height":"120px"}},Or={__name:"AnalyticsDashboard",setup(s){var b;const r=K(!1),e=lt(),t=e!=null&&e.isSuperAdmin?"ALL":String(((b=e==null?void 0:e.user)==null?void 0:b.identity_type)||"CC").toUpperCase(),a=K({timeRange:"month",dateRange:[],groupId:null,role:t,userId:null}),n=ut({}),o=K(""),i=Y(()=>a.value.role||"CC"),l=Y(()=>{if(e.isSuperAdmin)return["task_completion_rate","report_submission_rate","period_sales_amount","sales_achievement_rate","period_new_sign_amount","new_sign_count","new_sign_achievement_rate","period_referral_amount","referral_count","referral_achievement_rate","period_total_renewal_amount","total_renewal_achievement_rate","period_upgrade_amount","upgrade_count","upgrade_rate"];const w=["task_completion_rate","report_submission_rate","period_sales_amount"];return i.value==="CC"?w.concat(["period_new_sign_amount","new_sign_count","new_sign_achievement_rate","period_referral_amount","referral_count","referral_achievement_rate"]):i.value==="SS"?w.concat(["period_total_renewal_amount","total_renewal_achievement_rate","period_upgrade_amount","upgrade_count","upgrade_rate"]):w}),u={task_completion_rate:{name:"‰ªªÂä°ÂÆåÊàêÁéá"},period_sales_amount:{name:"ÈîÄÂîÆÊÄªÈ¢ù"},sales_achievement_rate:{name:"ÈîÄÂîÆÁõÆÊ†áËææÊàêÁéá"},period_new_sign_amount:{name:"Êñ∞ÂçïÈáëÈ¢ù"},new_sign_count:{name:"Êñ∞ÂçïÂçïÈáè"},new_sign_achievement_rate:{name:"Êñ∞ÂçïÁõÆÊ†áËææÊàêÁéá"},period_referral_amount:{name:"ËΩ¨‰ªãÁªçÈáëÈ¢ù"},referral_count:{name:"ËΩ¨‰ªãÁªçÂçïÈáè"},referral_achievement_rate:{name:"ËΩ¨‰ªãÁªçÁõÆÊ†áËææÊàêÁéá"},period_total_renewal_amount:{name:"ÊÄªÁª≠Ë¥πÈáëÈ¢ù"},total_renewal_achievement_rate:{name:"ÊÄªÁª≠Ë¥πÁõÆÊ†áËææÊàêÁéá"},period_upgrade_amount:{name:"ÂçáËà±ÈáëÈ¢ù"},upgrade_count:{name:"ÂçáËà±ÂçïÈáè"},upgrade_rate:{name:"ÂçáËà±Áéá"},report_submission_rate:{name:"Êó•Êä•Êèê‰∫§Áéá"}};function d(){const w=a.value.timeRange;if(w==="today"){const p=Re();a.value.dateRange=[p,p]}else w==="week"?a.value.dateRange=dt(new Date):w==="month"&&(a.value.dateRange=ct(new Date))}async function c(){var w;r.value=!0;try{const[p,S]=a.value.dateRange||[],g=a.value.groupId||void 0,M=a.value.userId||void 0,y=a.value.role||"CC",L=S||p||Re(),$=new Date(L),O=$.getFullYear(),E=$.getMonth()+1,{data:P}=await G.get("/analytics/data",{params:{start_date:p,end_date:S,group_id:g,user_id:M,role_scope:y}}),j=(P==null?void 0:P.metrics)||{};let le=null,Ve=null,Ze=null,Oe=null,k=null,B=null;if(y==="CC"||y==="ALL")try{const{data:D}=await G.get("/analytics/summary",{params:{identity_type:"CC",group_id:g,user_id:M,year:O,month:E}});if(le=(D==null?void 0:D.month)||null,Ze=(D==null?void 0:D.goal)||null,M)try{const{data:H}=await G.get("/goals/monthly/personal",{params:{identity_type:"CC",group_id:g,user_id:M,year:O,month:E},suppressErrorMessage:!0});k=(Array.isArray(H==null?void 0:H.items)?H.items[0]:null)||null}catch{}}catch{}if(y==="SS"||y==="ALL")try{const{data:D}=await G.get("/analytics/summary",{params:{identity_type:"SS",group_id:g,user_id:M,year:O,month:E}});if(Ve=(D==null?void 0:D.month)||null,Oe=(D==null?void 0:D.goal)||null,M)try{const{data:H}=await G.get("/goals/monthly/personal",{params:{identity_type:"SS",group_id:g,user_id:M,year:O,month:E},suppressErrorMessage:!0});B=(Array.isArray(H==null?void 0:H.items)?H.items[0]:null)||null}catch{}}catch{}const ee=le||{},U=Ve||{},ue=Ze||{},de=Oe||{},Ee=Number(ee.new_sign_amount||0)+Number(ee.referral_amount||0),Pe=Number(U.renewal_amount||0)+Number(U.upgrade_amount||0),ye=y==="CC"?Ee:y==="SS"?Pe:Ee+Pe,we=(()=>{const D=Number(U.renewal_amount||0)+Number(U.upgrade_amount||0);return y==="SS"||y==="ALL"?D:null})(),W={task_completion_rate:j.task_completion_rate??null,report_submission_rate:j.report_submission_rate??null,period_sales_amount:ye,period_new_sign_amount:y==="CC"||y==="ALL"?ee.new_sign_amount??null:null,new_sign_count:y==="CC"||y==="ALL"?ee.new_sign_count??null:null,period_referral_amount:y==="CC"||y==="ALL"?ee.referral_amount??null:null,referral_count:y==="CC"||y==="ALL"?ee.referral_count??null:null,period_total_renewal_amount:we,period_upgrade_amount:y==="SS"||y==="ALL"?U.upgrade_amount??null:null,upgrade_count:y==="SS"||y==="ALL"?U.upgrade_count??null:null},Ne=(()=>{if(M){if(y==="CC"){const xe=Number((k==null?void 0:k.new_sign_target_amount)||0),bt=Number((k==null?void 0:k.referral_target_amount)||0);return xe+bt}if(y==="SS")return Number((B==null?void 0:B.renewal_total_target_amount)||0);const D=Number((k==null?void 0:k.new_sign_target_amount)||0)+Number((k==null?void 0:k.referral_target_amount)||0),H=Number((B==null?void 0:B.renewal_total_target_amount)||0);return D+H}return y==="CC"?Number(ue.amount_target||0):y==="SS"?Number(de.amount_target||0):Number(ue.amount_target||0)+Number(de.amount_target||0)})();W.sales_achievement_rate=Ne>0&&ye!=null?Number(ye)/Ne*100:null;const ze=Number(M?(k==null?void 0:k.new_sign_target_amount)||0:ue.new_sign_target_amount||0);W.new_sign_achievement_rate=(y==="CC"||y==="ALL")&&ze>0&&W.period_new_sign_amount!=null?Number(W.period_new_sign_amount)/ze*100:null;const Be=Number(M?(k==null?void 0:k.referral_target_amount)||0:ue.referral_target_amount||0);W.referral_achievement_rate=(y==="CC"||y==="ALL")&&Be>0&&W.period_referral_amount!=null?Number(W.period_referral_amount)/Be*100:null;const We=Number(M?(B==null?void 0:B.renewal_total_target_amount)||0:de.renewal_total_target_amount||0);W.total_renewal_achievement_rate=(y==="SS"||y==="ALL")&&We>0&&we!=null?Number(we)/We*100:null;const Ke=Number(M?(B==null?void 0:B.upgrade_target_count)||0:de.upgrade_target_count||0),$e=Ke>0&&W.upgrade_count!=null?Number(W.upgrade_count)/Ke*100:null;if(M)W.upgrade_rate=$e;else{const D=((w=U==null?void 0:U.progress)==null?void 0:w.upgrade_rate)??null;W.upgrade_rate=$e??D??null}for(const D of Object.keys(n))delete n[D];Object.assign(n,W),o.value||(o.value="task_completion_rate")}catch{ve.error("Ëé∑ÂèñÊ±áÊÄªÊï∞ÊçÆÂ§±Ë¥•")}finally{r.value=!1}}function v(w){o.value=w}const m=K(!1),h=K("");async function f(w){try{const[p,S]=a.value.dateRange||[],M={question:`ËØ∑ÁîüÊàêÂΩìÂâçÁ≠õÈÄâËåÉÂõ¥‰∏ãÁöÑAIÊÄªÁªìÔºåÂπ∂ÈáçÁÇπÂÖ≥Ê≥®ÊåáÊ†áÔºö${w}`,output_target:a.value.userId?"personal":"team",role_scope:a.value.role||void 0,group_id:a.value.groupId||void 0,user_id:a.value.userId||void 0,start_date:p,end_date:S,page_context:"analytics_dashboard",identity_hint:a.value.role||void 0},{data:y}=await G.post("/ai/answer",M);h.value=(y==null?void 0:y.answer)||"‚Äî",m.value=!0}catch{ve.error("Ëé∑ÂèñAIÊ¥ûÂØüÂ§±Ë¥•")}}return ke(()=>{if(!e.user)try{e.initAuth()}catch{}e.isSuperAdmin&&a.value.role!=="ALL"&&(a.value.role="ALL"),d(),c()}),re(a,()=>{c()},{deep:!0}),(w,p)=>{const S=Z("el-button"),g=Z("el-card"),M=Z("el-tag"),y=Z("el-dialog");return C(),V("div",Dr,[p[8]||(p[8]=_("div",{class:"page-header"},[_("h1",{class:"page-title"},"Êï∞ÊçÆÂàÜÊûê‰ª™Ë°®Áõò"),_("p",{class:"page-description"},"Áªü‰∏ÄÁ≠õÈÄâ„ÄÅÂç°ÁâáÊ¶ÇËßà„ÄÅËÅîÂä®Ë∂ãÂäø‰∏éAIÊ¥ûÂØü")],-1)),x(g,{class:"content-card"},{header:A(()=>[_("div",Rr,[p[4]||(p[4]=_("span",null,"Á≠õÈÄâÊù°‰ª∂",-1)),_("div",Ir,[x(S,{loading:r.value,onClick:c},{default:A(()=>[...p[3]||(p[3]=[z("Âà∑Êñ∞",-1)])]),_:1},8,["loading"])])])]),default:A(()=>[x(Oa,{modelValue:a.value,"onUpdate:modelValue":p[0]||(p[0]=L=>a.value=L)},null,8,["modelValue"])]),_:1}),x(Ya,{summaryData:n,activeMetricKey:o.value,visibleKeys:l.value,onCardClick:v,onAiClick:f},null,8,["summaryData","activeMetricKey","visibleKeys"]),x(g,{class:"chart-card"},{header:A(()=>[_("div",Lr,[p[5]||(p[5]=_("span",null,"Ë∂ãÂäøÂàÜÊûê",-1)),_("div",kr,[o.value?(C(),F(M,{key:0,type:"primary",size:"small"},{default:A(()=>[z("ÊåáÊ†áÔºö"+T(o.value),1)]),_:1})):X("",!0)])])]),default:A(()=>[x(Ja,{metricKey:o.value,filterParams:a.value},null,8,["metricKey","filterParams"])]),_:1}),x(g,{class:"chart-card"},{header:A(()=>[_("div",Tr,[p[6]||(p[6]=_("span",null,"ÊéíË°åÊ¶ú",-1)),_("div",Vr,[o.value?(C(),F(M,{key:0,type:"primary",size:"small"},{default:A(()=>{var L;return[z("ÊåáÊ†áÔºö"+T(((L=u[o.value])==null?void 0:L.name)||o.value),1)]}),_:1})):X("",!0)])])]),default:A(()=>[x(Cr,{metricKey:o.value,filterParams:a.value},null,8,["metricKey","filterParams"])]),_:1}),x(y,{modelValue:m.value,"onUpdate:modelValue":p[2]||(p[2]=L=>m.value=L),title:"AIÊ¥ûÂØü",width:"620px"},{footer:A(()=>[x(S,{onClick:p[1]||(p[1]=L=>m.value=!1)},{default:A(()=>[...p[7]||(p[7]=[z("ÂÖ≥Èó≠",-1)])]),_:1})]),default:A(()=>[_("div",Zr,T(h.value||"‚Äî"),1)]),_:1},8,["modelValue"])])}}},zr=ne(Or,[["__scopeId","data-v-0af3e684"]]);export{zr as default};
